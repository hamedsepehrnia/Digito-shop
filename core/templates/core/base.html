{% load static %}
<!DOCTYPE html>

<html class="scroll-smooth" dir="rtl" lang="fa" id="html-root">

<head>
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <link href='{% static "./assets/image/fav.png" %}' rel="icon" type="image/x-icon"/>
    <link href='{% static "./assets/css/main.css" %}' rel="stylesheet"/>
    <title>فروشگاه آنلاین دیجیتو</title>
    <script>
        // اعمال dark mode قبل از لود کامل صفحه برای جلوگیری از فلاش
        (function() {
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                document.documentElement.classList.add('dark');
                document.documentElement.style.backgroundColor = '#111111';
                document.body.style.backgroundColor = '#111111';
                document.body.style.color = '#ffffff';
            }
        })();
    </script>
</head>
<body class="max-w-[1700px] mx-auto bg-white dark:bg-black transition-colors duration-300">
<!-- loading -->
<div class="z-50 fixed inset-0 flex flex-col items-center justify-center bg-gradient-to-bl from-zinc-50 to-zinc-100 transition-opacity duration-700"
     id="loading">
    <div class="wrapper">
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="circle"></div>
        <div class="shadow"></div>
        <div class="shadow"></div>
        <div class="shadow"></div>
    </div>
    <div class="flex items-center gap-6 mt-10">
        <img alt="" class="max-w-20 md:max-w-36" src='{% static "./assets/image/logo.png" %}'/>
        <div class="text-xl md:text-3xl font-yekanBakhExtraBold text-zinc-800 dark:text-primary-500">فروشگاه آنلاین دیجیتو</div>
    </div>
</div>
<!-- progress bar -->
<div id="progressBar"></div>
<header>
    <!-- top header -->
    <div class="flex justify-between bg-white dark:bg-zinc-900 shadow-lg dark:shadow-zinc-800/50 px-4 md:px-8 lg:px-14 py-5 relative transition-colors duration-300">
        <div class="flex justify-between items-center gap-x-5 w-full md:w-auto">
            <!-- btn menu mobile -->
            <svg class="md:hidden menu-mobile" fill="#000000" height="32" viewbox="0 0 256 256" width="32"
                 xmlns="http://www.w3.org/2000/svg">
                <path d="M224,128a8,8,0,0,1-8,8H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,128ZM40,72H216a8,8,0,0,0,0-16H40a8,8,0,0,0,0,16ZM216,184H40a8,8,0,0,0,0,16H216a8,8,0,0,0,0-16Z"></path>
            </svg>
            <!-- bg blur mobile -->
            <div class="fixed z-10 inset-0 bg-black/35 hidden transition-opacity duration-300" id="overlay"></div>
            <!-- Sidebar mobile -->
            <div class="z-20 fixed top-0 right-0 w-10/12 h-full bg-white dark:bg-zinc-900 shadow-lg dark:shadow-zinc-800/50 transform translate-x-full transition-all duration-300 ease-in-out"
                 id="mobile-menu">
                <div class="p-5 flex flex-col gap-y-3 justify-center items-center">
                    <!-- logo -->
                    <a href="/">
                        <img alt="" class="max-w-24 md:max-w-32 h-fit" src='{% static "./assets/image/logo.png" %}'/>
                    </a>
                    <!-- seacrh -->
                    <form method="get" action="{% url 'search_products' %}" class="relative block">
                        <input name="q" class="search-input rounded-full text-zinc-600 dark:text-zinc-100 bg-[#f0f0f0] dark:bg-zinc-800 px-5 py-2.5 w-64 text-sm placeholder:text-zinc-400 dark:placeholder:text-zinc-400 placeholder:text-sm focus:outline-0"
                               placeholder="جستجو..." type="text" required/>
                        <button type="submit" class="absolute left-3 top-3">
                            <img alt="" class="size-4"
                                 src='{% static "./assets/image/icons/lineicons_search-1.svg" %}'/>
                        </button>
                    </form>
                </div>
                <ul class="p-5 space-y-1 text-sm text-zinc-800 dark:text-white h-screen overflow-y-auto pb-48">
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg flex gap-x-2" href="#">
                            <svg fill="none" height="18" viewbox="0 0 24 24" width="18"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path class="fill-gray-700 group-hover/cat:fill-primary-500 transition"
                                      d="M11.25 18C11.25 18.1989 11.329 18.3897 11.4697 18.5303C11.6103 18.671 11.8011 18.75 12 18.75C12.1989 18.75 12.3897 18.671 12.5303 18.5303C12.671 18.3897 12.75 18.1989 12.75 18V15C12.75 14.8011 12.671 14.6103 12.5303 14.4697C12.3897 14.329 12.1989 14.25 12 14.25C11.8011 14.25 11.6103 14.329 11.4697 14.4697C11.329 14.6103 11.25 14.8011 11.25 15V18Z"
                                      fill=""></path>
                                <path class="fill-gray-700 group-hover/cat:fill-primary-500 transition"
                                      clip-rule="evenodd"
                                      d="M12 1.25C11.292 1.25 10.649 1.453 9.95 1.792C9.276 2.12 8.496 2.604 7.523 3.208L5.456 4.491C4.536 5.063 3.797 5.521 3.229 5.956C2.64 6.406 2.188 6.866 1.861 7.463C1.535 8.058 1.389 8.692 1.318 9.441C1.25 10.166 1.25 11.054 1.25 12.167V13.78C1.25 15.684 1.25 17.187 1.403 18.362C1.559 19.567 1.889 20.54 2.633 21.309C3.38 22.082 4.33 22.428 5.508 22.591C6.648 22.75 8.106 22.75 9.942 22.75H14.058C15.894 22.75 17.352 22.75 18.492 22.591C19.669 22.428 20.62 22.082 21.368 21.309C22.111 20.54 22.441 19.567 22.598 18.362C22.75 17.187 22.75 15.684 22.75 13.78V12.167C22.75 11.054 22.75 10.167 22.682 9.441C22.612 8.691 22.465 8.058 22.139 7.463C21.812 6.866 21.359 6.407 20.771 5.956C20.203 5.52 19.465 5.063 18.544 4.491L16.477 3.208C15.504 2.604 14.724 2.12 14.049 1.792C13.352 1.452 12.709 1.25 12 1.25ZM8.28 4.504C9.295 3.874 10.01 3.432 10.607 3.141C11.188 2.858 11.6 2.75 12 2.75C12.4 2.75 12.812 2.858 13.393 3.141C13.991 3.431 14.705 3.874 15.72 4.504L17.72 5.745C18.681 6.342 19.356 6.761 19.86 7.147C20.349 7.522 20.63 7.831 20.823 8.183C21.016 8.536 21.129 8.949 21.188 9.581C21.249 10.229 21.25 11.046 21.25 12.204V13.725C21.25 15.695 21.248 17.101 21.11 18.168C20.974 19.216 20.717 19.824 20.29 20.267C19.865 20.706 19.287 20.967 18.286 21.106C17.26 21.248 15.907 21.25 14 21.25H10C8.092 21.25 6.74 21.248 5.714 21.106C4.713 20.966 4.135 20.706 3.711 20.266C3.283 19.824 3.026 19.216 2.891 18.168C2.751 17.101 2.75 15.696 2.75 13.725V12.204C2.75 11.046 2.75 10.229 2.812 9.581C2.871 8.949 2.984 8.536 3.177 8.183C3.37 7.831 3.651 7.522 4.141 7.147C4.644 6.761 5.319 6.342 6.28 5.745L8.28 4.504Z"
                                      fill="" fill-rule="evenodd"></path>
                            </svg>
                            صفحه اصلی
                        </a>
                    </li>
                    {% comment %}
                    <!-- منوی شگفت انگیزها - غیرفعال شده برای توسعه آینده -->
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg flex gap-x-2" href="#">
                            <svg fill="none" height="18" viewbox="0 0 24 24" width="18"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path d="M9.144 2.5C6.487 2.56 4.935 2.815 3.874 3.875C2.813 4.935 2.562 6.487 2.5 9.145M14.856 2.5C17.513 2.56 19.065 2.815 20.126 3.875C21.187 4.935 21.439 6.487 21.5 9.145M14.856 21.5C17.513 21.44 19.065 21.185 20.126 20.125C21.187 19.065 21.439 17.513 21.5 14.855M9.144 21.5C6.487 21.44 4.935 21.185 3.874 20.125C2.813 19.065 2.561 17.513 2.5 14.855M8 8H8.009M16 16H16.009M8 16L16 8"
                                      stroke="#3f3f46" stroke-linecap="round" stroke-linejoin="round"
                                      stroke-width="1.5"></path>
                            </svg>
                            شگفت انگیزها
                        </a>
                    </li>
                    {% endcomment %}
                    <!-- منوی پرفروش ترین‌ها -->
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg flex gap-x-2" href="{% url 'bestseller_products' %}">
                            <svg fill="none" height="18" viewbox="0 0 24 24" width="18"
                                 xmlns="http://www.w3.org/2000/svg">
                                <path d="M17 15.245V22.117C17 22.2055 16.9766 22.2924 16.932 22.3688C16.8875 22.4452 16.8235 22.5085 16.7465 22.5521C16.6696 22.5957 16.5824 22.6181 16.4939 22.6171C16.4055 22.616 16.3189 22.5915 16.243 22.546L12 20L7.757 22.546C7.68104 22.5915 7.59436 22.616 7.50581 22.6171C7.41727 22.6181 7.33004 22.5956 7.25304 22.5519C7.17605 22.5081 7.11205 22.4447 7.06759 22.3681C7.02313 22.2916 6.9998 22.2046 7 22.116V15.246C5.70615 14.2101 4.76599 12.7979 4.30946 11.2045C3.85293 9.6112 3.90256 7.91539 4.45149 6.35147C5.00043 4.78756 6.02156 3.43275 7.37378 2.47428C8.726 1.51581 10.3425 1.001 12 1.001C13.6575 1.001 15.274 1.51581 16.6262 2.47428C17.9784 3.43275 18.9996 4.78756 19.5485 6.35147C20.0974 7.91539 20.1471 9.6112 19.6905 11.2045C19.234 12.7979 18.2939 14.2101 17 15.246M9 16.42V19.469L12 17.669L15 19.469V16.419C14.0466 16.8036 13.028 17.0009 12 17C10.972 17.0009 9.95338 16.8046 9 16.42ZM12 15C13.5913 15 15.1174 14.3679 16.2426 13.2426C17.3679 12.1174 18 10.5913 18 9C18 7.4087 17.3679 5.88258 16.2426 4.75736C15.1174 3.63214 13.5913 3 12 3C10.4087 3 8.88258 3.63214 7.75736 4.75736C6.63214 5.88258 6 7.4087 6 9C6 10.5913 6.63214 12.1174 7.75736 13.2426C8.88258 14.3679 10.4087 15 12 15Z"
                                      fill="#364153"></path>
                            </svg>
                            پرفروش ترین‌ها
                        </a>
                    </li>
                    <!-- categorys -->
                    {% load mptt_tags %}
                    <div class="border-y border-zinc-300 py-2">
                        {% recursetree categories %}
                        <li>
                            {% if node.get_children %}
                            <button class="menu-toggle flex justify-between w-full py-3 px-4 hover:bg-gray-100 rounded-lg">
                                <div class="flex items-center gap-x-1">
                                    <svg fill="none" height="20" viewbox="0 0 24 24" width="20"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="M15.25 2.75H8.75C7.09315 2.75 5.75 4.09315 5.75 5.75V18.25C5.75 19.9069 7.09315 21.25 8.75 21.25H15.25C16.9069 21.25 18.25 19.9069 18.25 18.25V5.75C18.25 4.09315 16.9069 2.75 15.25 2.75Z"
                                              stroke="#71717b" stroke-linecap="round" stroke-linejoin="round"
                                              stroke-width="1.5"></path>
                                        <path d="M11 17.75H13" stroke="#71717b" stroke-linecap="round"
                                              stroke-linejoin="round" stroke-width="1.5"></path>
                                    </svg>
                                    <span>{{ node.name }}</span>
                                </div>
                                <img alt="" class="w-4 transition-transform opacity-80"
                                     src='{% static "./assets/image/icons/arrowDown.svg" %}'/>
                            </button>
                            <ul class="submenu hidden pr-6 space-y-2">
                                {{ children }}
                                    </ul>
                            {% else %}
                            <a class="flex items-center gap-x-1 py-3 px-4 hover:bg-gray-100 rounded-lg block" href="{% url 'shop' %}?category={{ node.slug }}">
                                    <svg fill="none" height="20" viewbox="0 0 24 24" width="20"
                                         xmlns="http://www.w3.org/2000/svg">
                                        <path d="M15.25 2.75H8.75C7.09315 2.75 5.75 4.09315 5.75 5.75V18.25C5.75 19.9069 7.09315 21.25 8.75 21.25H15.25C16.9069 21.25 18.25 19.9069 18.25 18.25V5.75C18.25 4.09315 16.9069 2.75 15.25 2.75Z"
                                              stroke="#71717b" stroke-linecap="round" stroke-linejoin="round"
                                              stroke-width="1.5"></path>
                                        <path d="M11 17.75H13" stroke="#71717b" stroke-linecap="round"
                                              stroke-linejoin="round" stroke-width="1.5"></path>
                                    </svg>
                                <span>{{ node.name }}</span>
                            </a>
                            {% endif %}
                                </li>
                        {% endrecursetree %}
                    </div>
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg block" href= {% url 'blog' %}>
                            وبلاگ
                        </a>
                    </li>
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg block" href="{% url "about" %}">
                            درباره ما
                        </a>
                    </li>
                    <li>
                        <a class="py-3 px-4 hover:bg-gray-100 rounded-lg block" href="{% url "contact" %}">
                            تماس با ما
                        </a>
                    </li>
                </ul>
                <div class="bg-zinc-100 dark:bg-zinc-800 w-full h-16 px-2 py-4 flex justify-between items-center fixed bottom-0">
                    <div class="text-zinc-600 dark:text-white text-xs lg:text-sm">
                        همین حالا با پشتیبانی تماس بگیر
                    </div>
                    {% if contact_info and contact_info.phone %}
                    <a class="text-primary-500 dark:text-primary-300 flex text-xs lg:text-base gap-x-1 items-start" href="tel:{{ contact_info.phone }}">
                        {{ contact_info.phone }}
                        <img alt="" class="w-3 lg:w-5" src='{% static "./assets/image/icons/headphones.svg" %}'/>
                    </a>
                    {% else %}
                    <a class="text-primary-500 dark:text-primary-300 flex text-xs lg:text-base gap-x-1 items-start" href="tel:05144556677">
                        051-44556677
                        <img alt="" class="w-3 lg:w-5" src='{% static "./assets/image/icons/headphones.svg" %}'/>
                    </a>
                    {% endif %}
                </div>
            </div>
            <!-- logo -->
            <a href="/">
                <img alt="" class="max-w-24 md:max-w-32 h-fit" src='{% static "./assets/image/logo.png" %}'/>
            </a>
            <!-- empty -->
            <div class="md:hidden size-8">
            </div>
            <!-- seacrh -->
            <form method="get" action="{% url 'search_products' %}" class="relative hidden md:block">
                <input name="q" class="search-input rounded-full text-zinc-600 dark:text-zinc-100 bg-[#f0f0f0] dark:bg-zinc-800 px-5 py-2.5 w-80 placeholder:text-zinc-400 dark:placeholder:text-zinc-400 placeholder:text-sm focus:outline-0"
                       placeholder="جستجو..." type="text" required/>
                <button type="submit" class="absolute left-3 top-2.5">
                    <img alt="" class="size-5"
                         src='{% static "./assets/image/icons/lineicons_search-1.svg" %}'/>
                </button>
            </form>
        </div>
        <div class="hidden md:flex items-center gap-x-2 lg:gap-x-3">
            <div class="text-zinc-600 dark:text-white text-xs lg:text-sm">
                همین حالا با پشتیبانی تماس بگیر
            </div>
            <div class="text-zinc-300 dark:text-zinc-600">
                |
            </div>
            {% if contact_info and contact_info.phone %}
            <a class="text-primary-500 dark:text-primary-300 flex text-xs lg:text-base gap-x-1 items-start" href="tel:{{ contact_info.phone }}">
                {{ contact_info.phone }}
                <img alt="" class="w-3 lg:w-5" src='{% static "./assets/image/icons/headphones.svg" %}'/>
            </a>
            {% else %}
            <a class="text-primary-500 dark:text-primary-300 flex text-xs lg:text-base gap-x-1 items-start" href="tel:05144556677">
                051-44556677
                <img alt="" class="w-3 lg:w-5" src='{% static "./assets/image/icons/headphones.svg" %}'/>
            </a>
            {% endif %}
        </div>
        <svg class="hidden md:block absolute top-full md:right-4 lg:right-10 header-wave" fill="white" height="19"
             viewbox="0 0 158 19" width="158" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_4623_10410)">
                <path clip-rule="evenodd"
                      d="M101.486 -121.419C121.078 -114.984 140.312 -105 160.935 -105H506.5C535.495 -105 559 -81.4949 559 -52.5V-52.5C559 -23.5051 535.495 0 506.5 0H158.936C138.871 0 120.093 9.46189 100.984 15.5822C94.0537 17.8017 86.6668 19 79 19C71.3332 19 63.9463 17.8017 57.0164 15.5822C37.9074 9.46189 19.1287 0 -0.936457 0H-1468.5C-1497.49 0 -1521 -23.5051 -1521 -52.5V-52.5C-1521 -81.4949 -1497.49 -105 -1468.5 -105H-2.93493C17.6877 -105 36.9216 -114.984 56.5145 -121.419C63.5893 -123.743 71.1478 -125 79 -125C86.8522 -125 94.4107 -123.743 101.486 -121.419Z"
                      fill="white" fill-rule="evenodd"></path>
            </g>
            <defs>
                <clippath id="clip0_4623_10410">
                    <rect fill="white" height="19" width="158"></rect>
                </clippath>
            </defs>
        </svg>
    </div>
    <!-- bottom header -->
    <div class="md:bg-zinc-50 dark:md:bg-zinc-900 py-6 px-6 lg:px-14 justify-between flex transition-colors duration-300">
        <!-- menu -->
        <ul class="hidden md:flex gap-x-5 xl:gap-x-8">
            <!-- Mega Menu Container -->
            {% load mptt_tags %}
            <li>
          <div class="relative inline-block group">
            <a href="#" class="pt-1 flex gap-x-2 items-center group relative">
              <img class="mb-2 size-4" src='{% static "./assets/image/icons/category.svg" %}' alt="">
              <div class="main-menu-link relative text-zinc-600 dark:text-white text-sm group-hover:text-primary-500 dark:group-hover:text-primary-500 transition pb-2
                after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] 
                after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 
                group-hover:after:scale-x-100">
                دسته بندی ها
              </div>
              <svg class="group-hover:rotate-180 transition-all duration-300 fill-zinc-600 mb-2 group-hover:fill-primary-500" xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="#000000" viewBox="0 0 256 256">
                <path d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"></path>
              </svg>
            </a>
          
            <div id="dropdown-menu" class="absolute z-10 right-0 mt-2 md:w-2xl lg:w-4xl xl:w-7xl h-fit bg-white dark:bg-zinc-900 p-5 shadow-lg dark:shadow-zinc-800/50 rounded-3xl flex opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
              <ul class="w-1/4 rounded-2xl bg-white drop-shadow-custom flex flex-col gap-y-3 p-3">
                {% for category in categories %}
                <li class="category-item group/cat" data-category="cat{{ category.id }}">
                  <a href="{% url 'shop' %}?category={{ category.slug }}" class="flex items-center gap-x-1 text-sm rounded-lg px-4 py-3 {% if forloop.first %}text-gray-600 active-category{% else %}text-gray-700{% endif %} dark:text-white hover:text-primary-500 dark:hover:text-primary-400 cursor-pointer hover:bg-gradient-to-l hover:from-zinc-100 hover:to-transparent hover:transition-all transition-all">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="stroke-gray-600 group-hover/cat:stroke-primary-500 transition" d="M15.25 2.75H8.75C7.09315 2.75 5.75 4.09315 5.75 5.75V18.25C5.75 19.9069 7.09315 21.25 8.75 21.25H15.25C16.9069 21.25 18.25 19.9069 18.25 18.25V5.75C18.25 4.09315 16.9069 2.75 15.25 2.75Z" stroke="" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path class="stroke-gray-600 group-hover/cat:stroke-primary-500 transition" d="M11 17.75H13" stroke="" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg>
                    {{ category.name }}
                  </a>
                </li>
                {% empty %}
                <li class="text-gray-500 text-sm px-4 py-3">دسته‌بندی‌ای وجود ندارد</li>
                {% endfor %}
              </ul>
              <div class="w-2/3 p-4" id="subcategory-container">
                {% for category in categories %}
                <div data-parent="cat{{ category.id }}" class="subcategory-item grid grid-cols-2 xl:grid-cols-3 gap-y-5 gap-x-10 {% if not forloop.first %}hidden{% endif %}">
                  {% for child in category.children.all %}
                  <div>
                    <a href="{% url 'shop' %}?category={{ child.slug }}" class="flex gap-x-2 items-center mb-5">
                      <div class="w-fit min-w-fit text-primary-500 text-sm hover:text-primary-700 transition">
                        {{ child.name }}
                      </div>
                      <div class="w-full h-0.5 border-t border-dashed border-primary-500/30">
                      </div>
                    </a>
                    {% if child.children.all %}
                    <ul class="pr-4 flex flex-col gap-y-3 text-xs mb-3">
                      {% for grandchild in child.children.all %}
                      <li>
                        <a href="{% url 'shop' %}?category={{ grandchild.slug }}" class="text-zinc-500 hover:text-zinc-700 transition">
                          {{ grandchild.name }}
                        </a>
                      </li>
                      {% endfor %}
                    </ul>
                    {% endif %}
                  </div>
                  {% empty %}
                  <div class="text-gray-400 text-sm">زیرمجموعه‌ای وجود ندارد</div>
                  {% endfor %}
                      </div>
                {% endfor %}
                      </div>
            </div>
          </div>
        </li>
            
            <!-- JavaScript for Mega Menu Hover -->
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    const categoryItems = document.querySelectorAll('.category-item[data-category]');
                    const subcategoryItems = document.querySelectorAll('.subcategory-item[data-parent]');
                    
                    // Function to show a specific panel
                    function showPanel(panel) {
                        if (!panel) return;
                        // Hide all panels first
                        subcategoryItems.forEach(function(p) {
                            p.classList.add('hidden');
                        });
                        // Show the requested panel
                        panel.classList.remove('hidden');
                    }
                    
                    // Function to update active category styling
                    function setActiveCategory(item) {
                        document.querySelectorAll('.category-item a').forEach(function(link) {
                            link.classList.remove('bg-gradient-to-l', 'from-zinc-100', 'to-transparent', 'text-gray-600');
                            link.classList.add('text-gray-700');
                        });
                        const link = item.querySelector('a');
                        if (link) {
                            link.classList.add('bg-gradient-to-l', 'from-zinc-100', 'to-transparent', 'text-gray-600');
                            link.classList.remove('text-gray-700');
                        }
                    }
                    
                    // Attach hover events to category items
                    categoryItems.forEach(function(item) {
                        const categoryId = item.getAttribute('data-category');
                        if (!categoryId) return;
                        
                        const subcategoryPanel = document.querySelector('.subcategory-item[data-parent="' + categoryId + '"]');
                        if (!subcategoryPanel) return;
                        
                        item.addEventListener('mouseenter', function() {
                            showPanel(subcategoryPanel);
                            setActiveCategory(item);
                        });
                    });
                    
                    // Show first panel by default when menu opens
                    const firstPanel = document.querySelector('.subcategory-item[data-parent]');
                    if (firstPanel && !firstPanel.classList.contains('hidden')) {
                        // Already visible, do nothing
                    } else if (firstPanel) {
                        firstPanel.classList.remove('hidden');
                    }
                    
                    // Set first category as active by default
                    const firstCategory = document.querySelector('.category-item[data-category]');
                    if (firstCategory) {
                        setActiveCategory(firstCategory);
                    }
                });
            </script>

            {% comment %}
            <!-- منوی شگفت انگیزها - غیرفعال شده برای توسعه آینده -->
            <li>
            <a class="pt-1 flex gap-x-2 items-center group relative" href="#">
                <img alt="" class="mb-2 size-4.5" src='{% static "./assets/image/icons/discount.svg" %}'/>
                    <span class="relative text-zinc-600 text-sm group-hover:text-primary-500 transition pb-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 group-hover:after:scale-x-100">
                    شگفت انگیزها
                    </span>
            </a>
            </li>
            {% endcomment %}
            <!-- منوی پرفروش ترین‌ها -->
            <li>
            <a class="pt-1 flex gap-x-1 items-center group relative" href="{% url 'bestseller_products' %}">
                <img alt="" class="mb-2 size-4.5" src='{% static "./assets/image/icons/award.svg" %}'/>
                    <span class="main-menu-link relative text-zinc-600 dark:text-white text-sm group-hover:text-primary-500 dark:group-hover:text-primary-600 transition pb-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 group-hover:after:scale-x-100">
                    پرفروش ترین‌ها
                    </span>
            </a>
            </li>
            <li>
            <a class="pt-1 flex gap-x-2 items-center group relative" href="{% url 'blog' %}">
                    <span class="main-menu-link relative text-zinc-600 dark:text-white text-sm group-hover:text-primary-500 dark:group-hover:text-primary-600 transition pb-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 group-hover:after:scale-x-100">
                    وبلاگ
                    </span>
            </a>
            </li>
            <li>
            <a class="pt-1 flex gap-x-2 items-center group relative" href="{% url 'about' %}">
                    <span class="main-menu-link relative text-zinc-600 dark:text-white text-sm group-hover:text-primary-500 dark:group-hover:text-primary-600 transition pb-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 group-hover:after:scale-x-100">
                    درباره ما
                    </span>
            </a>
            </li>
            <li>
            <a class="pt-1 flex gap-x-2 items-center group relative" href="{% url 'contact' %}">
                    <span class="main-menu-link relative text-zinc-600 dark:text-white text-sm group-hover:text-primary-500 dark:group-hover:text-primary-600 transition pb-2 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-[2px] after:bg-primary-500 after:scale-x-0 after:origin-right after:transition-transform after:duration-300 group-hover:after:scale-x-100">
                    تماس با ما
                    </span>
            </a>
            </li>
        </ul>
        <!-- buttons -->
        <div class="flex gap-x-5">
            <!-- Dark Mode Toggle -->
            <button id="dark-mode-toggle" class="flex items-center justify-center p-2.5 rounded-xl bg-zinc-100 hover:bg-zinc-200 dark:bg-zinc-800 dark:hover:bg-zinc-700 transition-colors" title="تغییر تم">
                <svg id="dark-mode-icon" class="w-5 h-5 fill-zinc-700 dark:fill-primary-500" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <!-- Moon icon (for dark mode) -->
                    <path id="moon-icon" d="M21.64,13a1,1,0,0,0-1.05-.14,8.05,8.05,0,0,1-3.37.73A8.15,8.15,0,0,1,9.08,5.49a8.59,8.59,0,0,1,.25-2A1,1,0,0,0,8,2.36,10.14,10.14,0,1,0,22,14.05,1,1,0,0,0,21.64,13Zm-9.5,6.69A8.14,8.14,0,0,1,7.08,5.22v.27A10.15,10.15,0,0,0,17.22,15.63a9.79,9.79,0,0,0,2.1-.22A8.11,8.11,0,0,1,12.14,19.73Z" style="display: none;"/>
                    <!-- Sun icon (for light mode) -->
                    <path id="sun-icon" d="M12,2a1,1,0,0,0,1-1V1a1,1,0,0,0-2,0V1A1,1,0,0,0,12,2ZM4.22,5.64a1,1,0,0,0,.71.29,1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.42L4.93,3.52a1,1,0,0,0-1.42,1.42ZM2,12a1,1,0,0,0-1,1H1a1,1,0,0,0,0,2H1A1,1,0,0,0,2,12ZM4.22,18.36a1,1,0,0,0,0,1.42,1,1,0,0,0,.71.29,1,1,0,0,0,.71-.29L7.05,19.36a1,1,0,0,0-1.42-1.42ZM12,22a1,1,0,0,0-1,1V23a1,1,0,0,0,2,0V23A1,1,0,0,0,12,22ZM18.36,4.22a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42L19.36,2.29a1,1,0,0,0-1.42,1.42ZM22,12a1,1,0,0,0,1-1V11a1,1,0,0,0-2,0V11A1,1,0,0,0,22,12ZM18.36,19.78a1,1,0,0,0-.71.29,1,1,0,0,0,0,1.42l.71.71a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42ZM12,6a6,6,0,1,0,6,6A6,6,0,0,0,12,6ZM12,16a4,4,0,1,1,4-4A4,4,0,0,1,12,16Z"/>
                </svg>
            </button>
            <!-- cart -->
            <div class="absolute top-3 left-16 md:top-0 md:left-0 md:relative group cursor-pointer border-2 border-primary-500 hover:shadow-lg hover:bg-zinc-200 transition rounded-xl p-2.5">
                <a href="{% url 'cart' %}">
                <img alt="" src='{% static "./assets/image/icons/cart.svg" %}'/>
                </a>
                <span class="absolute -right-2 -top-2 flex size-6 drop-shadow-lg items-center justify-center rounded-full bg-white text-sm font-semibold text-primary-500 cart-count" {% if cart_items_count == 0 %}style="display: none;"{% endif %}>
                    {{ cart_items_count }}
          </span>
                <div class="z-50 hidden group-hover:block absolute -left-16 sm:left-0 top-11 w-96 md:w-[400px] rounded-2xl border border-zinc-300 dark:border-zinc-700 bg-white dark:bg-zinc-900 shadow-lg dark:shadow-zinc-800/50">
                    <!-- Items -->
                    {% if cart and cart.items.count > 0 %}
                    <div class="h-72 md:h-64">
                        <ul class="main-scroll h-full space-y-2 divide-y divide-gray-100 overflow-y-auto p-5 pl-2">
                            {% for item in cart.items.all|slice:":3" %}
                            <li id="header-cart-item-{{ item.id }}">
                                <div class="flex gap-x-2 pt-5">
                                    <!-- Product -->
                                    <div class="relative min-w-fit">
                                        <a href="{% url 'product' item.product.slug %}">
                                            {% if item.product.images.first %}
                                                <img alt="{{ item.product.title }}" class="h-[120px] w-[120px] object-cover rounded"
                                                     src="{{ item.product.images.first.image.url }}"/>
                                            {% else %}
                                                <img alt="{{ item.product.title }}" class="h-[120px] w-[120px] object-cover rounded bg-gray-100"
                                                 src='{% static "./assets/image/placeholder.svg" %}'/>
                                            {% endif %}
                                        </a>
                                    </div>
                                    <div class="w-full flex gap-x-1">
                                        <!-- Title -->
                                        <a class="line-clamp-2 h-12 text-zinc-700" href="{% url 'product' item.product.slug %}">
                                            {{ item.product.title }}
                                        </a>
                                        <!-- delete -->
                                        <div class="size-8 group cursor-pointer rounded-lg p-1 bg-primary-400 hover:bg-primary-500 transition header-remove-item" data-item-id="{{ item.id }}">
                                            <svg fill="none" height="24" viewbox="0 0 24 24" width="24"
                                                 xmlns="http://www.w3.org/2000/svg">
                                                <path class="stroke-white" d="M20.5 6H3.5M9.5 11L10 16M14.5 11L14 16"
                                                      stroke="" stroke-linecap="round" stroke-width="1.5"></path>
                                                <path class="stroke-white"
                                                      d="M6.5 6H6.61C7.01245 5.98972 7.40242 5.85822 7.72892 5.62271C8.05543 5.3872 8.30325 5.05864 8.44 4.68L8.474 4.577L8.571 4.286C8.654 4.037 8.696 3.913 8.751 3.807C8.85921 3.59939 9.01451 3.41999 9.20448 3.28316C9.39444 3.14633 9.6138 3.05586 9.845 3.019C9.962 3 10.093 3 10.355 3H13.645C13.907 3 14.038 3 14.155 3.019C14.3862 3.05586 14.6056 3.14633 14.7955 3.28316C14.9855 3.41999 15.1408 3.59939 15.249 3.807C15.304 3.913 15.346 4.037 15.429 4.286L15.526 4.577C15.6527 4.99827 15.9148 5.36601 16.2717 5.62326C16.6285 5.88051 17.0603 6.01293 17.5 6"
                                                      stroke="black" stroke-width="1.5"></path>
                                                <path class="stroke-white"
                                                      d="M18.374 15.4C18.197 18.054 18.108 19.381 17.243 20.19C16.378 20.999 15.048 21 12.387 21H11.613C8.95299 21 7.62299 21 6.75699 20.19C5.89199 19.381 5.80399 18.054 5.62699 15.4L5.16699 8.5M18.833 8.5L18.633 11.5"
                                                      stroke="black" stroke-linecap="round" stroke-width="1.5"></path>
                                            </svg>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex justify-between px-6 w-full pb-2">
                                    <!-- Quantity Container 1 -->
                                    <div class="quantity-container flex h-10 max-w-28 items-center justify-between rounded-lg border border-gray-100 px-2 py-1">
                                        <button class="cursor-pointer header-update-quantity" data-item-id="{{ item.id }}" data-action="increment" type="button">
                                            <svg class="fill-green-500" height="18" viewbox="0 0 256 256" width="18"
                                                 xmlns="http://www.w3.org/2000/svg">
                                                <path d="M222,128a6,6,0,0,1-6,6H134v82a6,6,0,0,1-12,0V134H40a6,6,0,0,1,0-12h82V40a6,6,0,0,1,12,0v82h82A6,6,0,0,1,222,128Z"></path>
                                            </svg>
                                        </button>
                                        <input class="flex h-5 w-full grow select-none items-center justify-center bg-transparent dark:bg-transparent text-center text-sm text-zinc-700 dark:text-zinc-100 outline-none header-cart-quantity"
                                               data-item-id="{{ item.id }}"
                                               disabled="" type="number" value="{{ item.quantity }}"/>
                                        <button class="cursor-pointer header-update-quantity" data-item-id="{{ item.id }}" data-action="decrement" type="button">
                                            <svg class="fill-red-500" height="18" viewbox="0 0 256 256" width="18"
                                                 xmlns="http://www.w3.org/2000/svg">
                                                <path d="M222,128a6,6,0,0,1-6,6H40a6,6,0,0,1,0-12H216A6,6,0,0,1,222,128Z"></path>
                                            </svg>
                                        </button>
                                    </div>
                                    <!-- Price -->
                                    <div class="text-gray-700 dark:text-zinc-100 header-cart-item-total" data-item-id="{{ item.id }}">
                                        <span class="text-lg font-bold">{{ item.get_total_price|floatformat:0 }}</span>
                                        <span class="text-sm">تومان</span>
                                    </div>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="p-5 border-t border-zinc-200">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-zinc-600 dark:text-zinc-200">جمع کل:</span>
                            <span class="text-primary-500 dark:text-primary-300 font-bold header-cart-total-price">{{ cart_total_price|floatformat:0 }}</span>
                            <span class="text-primary-500 dark:text-primary-300 font-bold"> تومان</span>
                            </div>
                        <a href="{% url 'cart' %}" class="block w-full bg-primary-500 hover:bg-primary-400 text-white text-center py-2 rounded-lg transition">
                            مشاهده سبد خرید
                        </a>
                    </div>
                    {% else %}
            <div class="text-zinc-600 dark:text-zinc-300 text-center py-10 font-yekanBakhRegular flex justify-center items-center gap-x-1">
                        <img src='{% static "./assets/image/icons/cancel.svg" %}' alt="">
                        سبد خرید خالی است !
                    </div>
                    {% endif %}
                </div>
            </div>
            <!-- login / register -->
            {% if user.is_authenticated %}
                <a class="open-modal absolute md:static top-3.5 left-3 md:flex bg-gradient-to-bl from-primary-500 to-primary-400 dark:from-primary-500 dark:to-primary-500 hover:opacity-90 hover:shadow-lg transition rounded-xl p-2.5 items-center gap-x-2 text-sm text-white"
                   href={% url 'dashboard' %}>
                    <p class="hidden lg:block text-white dark:text-white">
                        ناحیه کاربری
                    </p>
                    <img alt="" src='{% static "./assets/image/icons/user.svg" %}'/>
                </a>
            {% else %}
                <a class="open-modal absolute md:static top-3.5 left-3 md:flex bg-gradient-to-bl from-primary-500 to-primary-400 dark:from-primary-500 dark:to-primary-500 hover:opacity-90 hover:shadow-lg transition rounded-xl p-2.5 items-center gap-x-2 text-sm text-white"
                   data-modal="modal1" href="#">
                    <p class="hidden lg:block text-white dark:text-white">
                        ورود | ثبت نام
                    </p>
                    <img alt="" src='{% static "./assets/image/icons/user.svg" %}'/>
                </a>
            {% endif %}
        </div>
    </div>
    <!-- modal login -->
    <div class="modal fixed inset-0 bg-black/20 bg-opacity-50 hidden flex items-center justify-center transition-opacity duration-300 z-50"
         id="modal1">
        <div class="modal-box bg-white dark:bg-zinc-900 p-6 rounded-3xl shadow-lg dark:shadow-zinc-800/50 w-10/12 md:w-6/12 lg:w-5/12 xl:w-3/12 opacity-0 scale-90 transition-all duration-300">
            <!-- logo -->
            <img alt="" class="max-w-32 h-fit mx-auto" src='{% static "./assets/image/logo.png" %}'/>

            <!-- login -->
            <div class="pt-5">
                <p class="text-lg text-zinc-800 dark:text-primary-500">ورود / عضویت</p>
                <p class="text-sm text-zinc-500 dark:text-primary-400 mt-8">شماره موبایل خود را وارد کنید:</p>

                <form id="otp-form" class="relative mt-2">
                    {% csrf_token %}
                    <input name="phone"
                           class="rounded-xl text-zinc-600 bg-[#f0f0f0] pl-10 pr-4 py-2.5 w-full placeholder:text-zinc-400 placeholder:text-sm focus:outline-0"
                           placeholder="09........." type="tel" required/>
                    <a href="#">
                        <img alt="" class="top-3 absolute left-3 size-5"
                             src='{% static "./assets/image/icons/phone.svg" %}'/>
                    </a>

                    <button type="submit"
                            class="text-center w-1/2 mx-auto mt-7 bg-gradient-to-bl from-primary-500 to-primary-400 hover:opacity-90 hover:shadow-lg transition rounded-2xl px-2.5 py-3 flex justify-center items-center gap-x-2 text-sm text-white">
                        ارسال کد تایید
                    </button>
                </form>
            </div>
            <!-- verify -->
            <div class="pt-5 hidden" id="verify-section">
                <p class="text-lg text-zinc-800">تایید شماره موبایل</p>
                <p class="text-sm text-zinc-500 mt-8">کد ۶ رقمی ارسال شده را وارد کنید:</p>

                <div class="input-field mb-5 flex flex-row-reverse gap-x-4 justify-center mt-2">
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                    <input maxlength="1" type="text" inputmode="numeric"
                           class="verify-code border-2 border-zinc-400 focus:border-primary-400 transition w-10 h-12 rounded-md outline-none text-center text-zinc-700"
                           required/>
                </div>

                <button id="verify-code-btn"
                        class="text-center w-1/2 mx-auto mt-7 bg-gradient-to-bl from-primary-500 to-primary-400 hover:opacity-90 hover:shadow-lg transition rounded-2xl px-2.5 py-3 flex justify-center items-center gap-x-2 text-sm text-white">
                    ورود
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("otp-form");

            form.addEventListener("submit", e => {
                e.preventDefault();
                const phone = form.querySelector('input[name="phone"]').value.trim();
                if (!phone.startsWith("09") || phone.length !== 11) return alert("شماره موبایل معتبر وارد کنید.");

                fetch("/auth/ajax/send-otp/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "X-CSRFToken": form.querySelector('[name=csrfmiddlewaretoken]').value,
                    },
                    body: `phone=${encodeURIComponent(phone)}`
                })
                    .then(r => r.json())
                    .then(d => {
                        if (!d.success) return alert(d.error || "خطا");
                        // نمایش OTP فقط در حالت توسعه (وقتی otp در پاسخ وجود دارد)
                        if (d.otp) {
                            alert("کد تست: " + d.otp);
                        } else if (d.message) {
                            alert(d.message);
                        }
                        document.getElementById("verify-section").classList.remove("hidden");
                        // فوکوس روی اولین باکس کد تایید
                        const firstCodeInput = document.querySelectorAll(".verify-code")[0];
                        if (firstCodeInput) {
                            setTimeout(() => firstCodeInput.focus(), 100);
                        }
                    });
            });

            // مدیریت باکس‌های کد تایید - انتقال خودکار به باکس بعدی
            const codeInputs = document.querySelectorAll(".verify-code");
            codeInputs.forEach((input, index) => {
                // وقتی کاراکتری تایپ می‌شود
                input.addEventListener("input", (e) => {
                    const value = e.target.value;
                    // فقط اعداد را بپذیر
                    if (value && !/^\d$/.test(value)) {
                        e.target.value = '';
                        return;
                    }
                    
                    // اگر کاراکتر معتبر وارد شد، به باکس بعدی برو
                    if (value && index < codeInputs.length - 1) {
                        codeInputs[index + 1].focus();
                    }
                });

                // مدیریت کلید Backspace
                input.addEventListener("keydown", (e) => {
                    if (e.key === "Backspace" && !e.target.value && index > 0) {
                        codeInputs[index - 1].focus();
                    }
                });

                // مدیریت Paste
                input.addEventListener("paste", (e) => {
                    e.preventDefault();
                    const pastedData = (e.clipboardData || window.clipboardData).getData("text").trim();
                    if (/^\d+$/.test(pastedData)) {
                        const digits = pastedData.split("").slice(0, 6);
                        digits.forEach((digit, i) => {
                            if (index + i < codeInputs.length) {
                                codeInputs[index + i].value = digit;
                            }
                        });
                        // فوکوس روی آخرین باکس پر شده
                        const lastFilledIndex = Math.min(index + digits.length - 1, codeInputs.length - 1);
                        codeInputs[lastFilledIndex].focus();
                    }
                });
            });

            document.getElementById("verify-code-btn").addEventListener("click", () => {
                const phone = form.querySelector('input[name="phone"]').value.trim();
                const code = [...document.querySelectorAll(".verify-code")].map(i => i.value.trim()).join("");

                if (code.length !== 6 || isNaN(code)) return alert("کد نامعتبر است.");

                fetch("/auth/ajax/verify-otp/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "X-CSRFToken": form.querySelector('[name=csrfmiddlewaretoken]').value,
                    },
                    body: `otp=${encodeURIComponent(code)}&phone=${encodeURIComponent(phone)}`
                })
                    .then(r => r.json())
                    .then(d => {
                        if (!d.success) return alert("کد اشتباه است!");

                        // ✅ ریدایرکت کن اگه سرور فرستاده
                        if (d.redirect) {
                            window.location.href = d.redirect;
                        } else {
                            location.reload();  // fallback
                        }
                    });
            });
        });
    </script>

    {% block content %}
    {% endblock %}
    <footer class="bg-white border-t border-zinc-200 w-full px-5 md:px-10 py-5">
        <!-- logo, des, go to up -->
        <div class="flex gap-x-8 gap-y-4 items-center md:items-start flex-wrap md:flex-nowrap justify-between">
            <div class="w-4/12 md:w-1/12 order-1 md:order-none">
                <img alt="" class="w-full" src='{% static "./assets/image/logo.png" %}'/>
            </div>
            <div class="md:w-10/12 text-xs text-zinc-400 leading-7 order-3 md:order-none text-justify">
                {% if footer_settings and footer_settings.description %}
                    {{ footer_settings.description }}
                {% else %}
                    دیجیتو فروشگاه آنلاین معتبری است که انواع کالاهای دیجیتال مانند گوشی، لپ‌تاپ، تبلت و لوازم جانبی را با
                    ضمانت
                    اصالت و ارسال سریع ارائه می‌دهد. با تنوع گسترده محصولات، قیمت‌های رقابتی و پشتیبانی حرفه‌ای، خریدی آسان
                    و
                    مطمئن را تجربه کنید. بررسی تخصصی، مقایسه و انتخاب آگاهانه از مزایای خرید از دیجیتو است. برای دسترسی به
                    جدیدترین محصولات دیجیتال، همین حالا به دیجیتو سر بزنید!
                {% endif %}
            </div>
            <div class="md:w-1/12 order-2 md:order-none">
                <button class="flex items-center cursor-pointer w-28 gap-x-2 px-3 py-2 text-zinc-400 text-xs md:text-sm"
                        id="btn-back-to-top" type="button">
                    برو به بالا
                    <svg fill="none" height="16" viewbox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_2028_6)">
                            <path d="M12.707 3.63599C12.5194 3.44852 12.2651 3.3432 12 3.3432C11.7348 3.3432 11.4805 3.44852 11.293 3.63599L5.63598 9.29299C5.54047 9.38523 5.46428 9.49558 5.41188 9.61758C5.35947 9.73959 5.33188 9.87081 5.33073 10.0036C5.32957 10.1364 5.35487 10.268 5.40516 10.3909C5.45544 10.5138 5.52969 10.6255 5.62358 10.7194C5.71747 10.8133 5.82913 10.8875 5.95202 10.9378C6.07492 10.9881 6.2066 11.0134 6.33938 11.0122C6.47216 11.0111 6.60338 10.9835 6.72538 10.9311C6.84739 10.8787 6.95773 10.8025 7.04998 10.707L11 6.75699V20C11 20.2652 11.1053 20.5196 11.2929 20.7071C11.4804 20.8946 11.7348 21 12 21C12.2652 21 12.5195 20.8946 12.7071 20.7071C12.8946 20.5196 13 20.2652 13 20V6.75699L16.95 10.707C17.1386 10.8891 17.3912 10.9899 17.6534 10.9877C17.9156 10.9854 18.1664 10.8802 18.3518 10.6948C18.5372 10.5094 18.6424 10.2586 18.6447 9.99639C18.6469 9.73419 18.5461 9.48159 18.364 9.29299L12.707 3.63599Z"
                                  fill="#9f9fa9"></path>
                        </g>
                        <defs>
                            <clippath id="clip0_2028_6">
                                <rect fill="white" height="24" width="24"></rect>
                            </clippath>
                        </defs>
                    </svg>
                </button>
            </div>
        </div>
        <!-- services -->
        <div class="grid grid-cols-2 md:grid-cols-5 mt-16 mb-14 gap-y-8">
            <div class="flex justify-center items-center gap-2">
                <div>
                    <svg fill="none" height="40" viewbox="0 0 48 49" width="40" xmlns="http://www.w3.org/2000/svg">
                        <path d="M38.94 39.435C39.365 39.415 39.764 39.395 40.136 39.375C42.413 39.254 44.236 37.539 44.449 35.27C44.694 32.671 44.954 28.86 44.994 24.152C45.001 23.332 44.834 22.518 44.452 21.793C43.462 19.915 41.143 16.1 37.655 13.799C36.917 13.313 36.043 13.1 35.159 13.07C32.623 12.985 29.829 12.922 26.986 12.875"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M3.015 25.75C3.005 26.29 3 26.837 3 27.386C3 30.882 3.21 33.641 3.439 35.603C3.685 37.72 5.419 39.242 7.547 39.359C8.007 39.384 8.511 39.41 9.06 39.436"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path clip-rule="evenodd"
                              d="M34.336 17.929C36.517 19.166 38.107 21.549 39.038 23.277C39.608 24.337 38.96 25.579 37.76 25.682C36.12 25.824 34.617 25.72 33.558 25.589C32.638 25.475 32 24.674 32 23.747V19.37C32.0003 18.9405 32.1711 18.5287 32.4748 18.2251C32.7786 17.9215 33.1905 17.751 33.62 17.751C33.87 17.751 34.118 17.805 34.336 17.929Z"
                              fill-rule="evenodd" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M27 25.75H15H3V14.75C3 11.773 3.094 9.487 3.206 7.82C3.349 5.691 4.991 4.085 7.121 3.957C8.962 3.847 11.558 3.75 15 3.75C18.442 3.75 21.038 3.847 22.878 3.957C25.009 4.085 26.651 5.691 26.794 7.821C26.906 9.487 27 11.773 27 14.75V25.75Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M19.9771 39.73C22.6596 39.7569 25.3425 39.7569 28.0251 39.73" stroke="#a1a1aa"
                              stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M28 40.25C28 41.7087 28.5795 43.1076 29.6109 44.1391C30.6424 45.1705 32.0413 45.75 33.5 45.75C34.9587 45.75 36.3576 45.1705 37.3891 44.1391C38.4205 43.1076 39 41.7087 39 40.25C39 38.7913 38.4205 37.3924 37.3891 36.3609C36.3576 35.3295 34.9587 34.75 33.5 34.75C32.0413 34.75 30.6424 35.3295 29.6109 36.3609C28.5795 37.3924 28 38.7913 28 40.25Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M9 40.25C9 41.7087 9.57946 43.1076 10.6109 44.1391C11.6424 45.1705 13.0413 45.75 14.5 45.75C15.9587 45.75 17.3576 45.1705 18.3891 44.1391C19.4205 43.1076 20 41.7087 20 40.25C20 38.7913 19.4205 37.3924 18.3891 36.3609C17.3576 35.3295 15.9587 34.75 14.5 34.75C13.0413 34.75 11.6424 35.3295 10.6109 36.3609C9.57946 37.3924 9 38.7913 9 40.25Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                    </svg>
                </div>
                <div class="flex flex-col gap-y-2">
                    <div class="text-sm text-zinc-600">
                        ارسال سریع
                    </div>
                    <div class="text-xs text-zinc-400">
                        ارسال با جدیدترین تکنولوژی
                    </div>
                </div>
            </div>
            <div class="flex justify-center items-center gap-2">
                <div>
                    <svg fill="none" height="40" viewbox="0 0 48 49" width="40" xmlns="http://www.w3.org/2000/svg">
                        <path d="M44.279 18.75C44.465 18.436 44.596 18.078 44.659 17.678C44.846 16.49 45 14.752 45 12.252C45 9.752 44.846 8.014 44.66 6.826C44.413 5.263 43.124 4.329 41.547 4.209C38.852 4.006 33.575 3.752 24 3.752C14.425 3.752 9.148 4.006 6.453 4.209C4.876 4.329 3.587 5.263 3.341 6.826C3.154 8.014 3 9.752 3 12.252C3 14.752 3.154 16.49 3.34 17.678C3.404 18.078 3.535 18.436 3.721 18.75"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M36.316 10.713C37.819 10.838 38.961 12.093 38.976 13.602C39.037 19.418 38.999 27.71 38.636 38.214C38.542 40.898 36.646 43.118 33.971 43.359C31.647 43.568 28.355 43.75 23.943 43.75C19.555 43.75 16.295 43.57 13.998 43.362C11.338 43.122 9.45799 40.913 9.36599 38.244C8.99999 27.725 8.96299 19.423 9.02299 13.602C9.03899 12.094 10.181 10.838 11.684 10.712C14.77 10.456 18.842 10.252 24 10.252C29.158 10.252 33.23 10.456 36.316 10.712V10.713Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M25 43.746V10.254" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M32 43.51V10.432" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M17.221 37.75C16.078 37.75 15.123 36.963 15.056 35.822C15.017 35.132 14.9984 34.4411 15 33.75C15 32.915 15.023 32.23 15.056 31.678C15.123 30.537 16.078 29.75 17.22 29.75H17.778C18.921 29.75 19.876 30.537 19.944 31.678C19.976 32.23 19.999 32.915 19.999 33.75C19.999 34.585 19.976 35.27 19.944 35.822C19.877 36.963 18.922 37.75 17.779 37.75H17.221Z"
                              stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                    </svg>
                </div>
                <div class="flex flex-col gap-y-2">
                    <div class="text-sm text-zinc-600">
                        ارسال سریع
                    </div>
                    <div class="text-xs text-zinc-400">
                        ارسال با جدیدترین تکنولوژی
                    </div>
                </div>
            </div>
            <div class="flex justify-center items-center gap-2">
                <div>
                    <svg fill="none" height="40" viewbox="0 0 48 49" width="40" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.44404 8.207C5.21404 8.373 3.53104 9.969 3.32404 12.197C3.16972 13.9221 3.06168 15.6511 3.00004 17.382C2.96504 18.306 3.60004 19.099 4.40004 19.562C5.31149 20.0871 6.06861 20.8429 6.59524 21.7534C7.12187 22.664 7.39944 23.6971 7.40004 24.749C7.39927 25.8007 7.12161 26.8337 6.59499 27.744C6.06837 28.6544 5.31134 29.41 4.40004 29.935C3.60004 30.399 2.96504 31.192 3.00004 32.116C3.08504 34.316 3.20304 36.013 3.32304 37.303C3.53004 39.53 5.21304 41.126 7.44304 41.293C10.417 41.515 15.553 41.75 24 41.75C32.447 41.75 37.583 41.516 40.556 41.293C42.786 41.127 44.469 39.531 44.676 37.303C44.796 36.014 44.913 34.317 44.998 32.118C45.034 31.193 44.398 30.401 43.598 29.937C42.687 29.4116 41.9304 28.6557 41.4041 27.7452C40.8778 26.8347 40.6005 25.8017 40.6 24.75C40.6007 23.6981 40.8783 22.665 41.405 21.7545C41.9316 20.844 42.6887 20.0881 43.6 19.563C44.4 19.1 45.035 18.307 45 17.383C44.9388 15.6514 44.8311 13.9218 44.677 12.196C44.47 9.969 42.787 8.373 40.557 8.206C37.583 7.985 32.446 7.75 24 7.75C15.553 7.75 10.417 7.984 7.44404 8.207Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M33.022 33.69C33.674 32.983 34 32 34 30.737C34 29.492 33.674 28.517 33.022 27.81C32.37 27.103 31.529 26.75 30.5 26.75C29.456 26.75 28.609 27.103 27.956 27.81C27.319 28.517 27 29.492 27 30.737C27 31.999 27.319 32.983 27.956 33.69C28.609 34.397 29.456 34.75 30.5 34.75C31.529 34.75 32.37 34.397 33.022 33.69Z"
                              stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M20.022 21.69C20.674 20.983 21 20 21 18.737C21 17.492 20.674 16.517 20.022 15.81C19.37 15.103 18.529 14.75 17.5 14.75C16.456 14.75 15.609 15.103 14.957 15.81C14.319 16.517 14 17.492 14 18.737C14 19.999 14.319 20.983 14.957 21.69C15.609 22.397 16.457 22.75 17.5 22.75C18.529 22.75 19.37 22.397 20.022 21.69Z"
                              stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M32 16.75L16 32.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                    </svg>
                </div>
                <div class="flex flex-col gap-y-2">
                    <div class="text-sm text-zinc-600">
                        ارسال سریع
                    </div>
                    <div class="text-xs text-zinc-400">
                        ارسال با جدیدترین تکنولوژی
                    </div>
                </div>
            </div>
            <div class="flex justify-center items-center gap-2">
                <div>
                    <svg fill="none" height="40" viewbox="0 0 48 49" width="40" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6 21.563V31.75C6 35.788 6.16 38.79 6.343 40.894C6.553 43.316 8.425 45.114 10.848 45.306C13.63 45.526 17.942 45.75 24 45.75C30.058 45.75 34.369 45.527 37.152 45.306C39.575 45.114 41.448 43.316 41.657 40.894C41.84 38.79 42 35.788 42 31.75V21.562"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M3.29 20.02C3.582 21.038 4.59 21.524 5.647 21.553C8.28 21.627 14.167 21.75 24 21.75C33.833 21.75 39.72 21.627 42.353 21.553C43.411 21.523 44.418 21.038 44.71 20.02C44.873 19.45 45 18.7 45 17.75C45 16.8 44.873 16.05 44.71 15.48C44.418 14.462 43.41 13.976 42.353 13.947C39.72 13.873 33.833 13.75 24 13.75C14.167 13.75 8.28 13.873 5.647 13.947C4.589 13.977 3.582 14.462 3.29 15.48C3.127 16.05 3 16.8 3 17.75C3 18.7 3.127 19.45 3.29 20.02Z"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M24 21.75V45.75" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M24 13.75C24 10.75 20.5 3.75 15.25 3.75C12.187 3.75 10 6.436 10 9.75C10 11.287 10.505 12.688 11.337 13.75"
                              stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M24 13.75C24 10.75 27.5 3.75 32.75 3.75C35.813 3.75 38 6.436 38 9.75C38 11.287 37.495 12.688 36.663 13.75"
                              stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                    </svg>
                </div>
                <div class="flex flex-col gap-y-2">
                    <div class="text-sm text-zinc-600">
                        ارسال سریع
                    </div>
                    <div class="text-xs text-zinc-400">
                        ارسال با جدیدترین تکنولوژی
                    </div>
                </div>
            </div>
            <div class="flex justify-center items-center gap-2">
                <div>
                    <svg fill="none" height="40" viewbox="0 0 48 49" width="40" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 3.75C15 3.75 10.885 3.75 6.734 4.022C5.8344 4.07821 4.98626 4.46087 4.34881 5.09813C3.71137 5.73539 3.32847 6.58342 3.272 7.483C3 11.635 3 15.75 3 15.75"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M33 3.75C33 3.75 37.115 3.75 41.266 4.022C42.1656 4.07821 43.0137 4.46087 43.6512 5.09813C44.2886 5.73539 44.6715 6.58342 44.728 7.483C45 11.635 45 15.75 45 15.75"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M33 45.75C33 45.75 37.115 45.75 41.266 45.478C42.1656 45.4218 43.0137 45.0391 43.6512 44.4019C44.2886 43.7646 44.6715 42.9166 44.728 42.017C45 37.865 45 33.75 45 33.75"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M15 45.75C15 45.75 10.885 45.75 6.734 45.478C5.8344 45.4218 4.98626 45.0391 4.34881 44.4019C3.71137 43.7646 3.32847 42.9166 3.272 42.017C3 37.865 3 33.75 3 33.75"
                              stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round" stroke-width="3"></path>
                        <path d="M36 13.75V35.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M12 13.75V35.75" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M30 13.75V29.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M30 35.75V34.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M24 13.75V29.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M24 35.75V34.75" stroke="#ed1945" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M18 13.75V29.75" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                        <path d="M18 35.75V34.75" stroke="#a1a1aa" stroke-linecap="round" stroke-linejoin="round"
                              stroke-width="3"></path>
                    </svg>
                </div>
                <div class="flex flex-col gap-y-2">
                    <div class="text-sm text-zinc-600">
                        ارسال سریع
                    </div>
                    <div class="text-xs text-zinc-400">
                        ارسال با جدیدترین تکنولوژی
                    </div>
                </div>
            </div>
        </div>
        <!-- links -->
        <div class="flex flex-col md:flex-row gap-y-8">
            {% if footer_groups %}
            <div class="md:w-4/12 flex justify-between">
                {% for group in footer_groups %}
                <div>
                    <div class="text-zinc-500 mb-4 text-sm">
                        {{ group.title }}
                    </div>
                    <div class="">
                        <ul class="flex flex-col gap-y-5">
                            {% for link in group.links.all %}
                            {% if link.is_active %}
                            <a href="{{ link.url }}">
                                <li class="text-zinc-400 hover:text-primary-500 transition-all text-xs hover:pr-1 ease-out duration-300">
                                    {{ link.title }}
                                </li>
                            </a>
                            {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
            <div class="md:w-4/12 flex justify-center gap-x-7">
                <img alt="" class="h-fit max-w-20 md:max-w-28"
                     src='{% static "./assets/image/service/symbol-02.png" %}'/>
                <img alt="" class="h-fit max-w-20 md:max-w-28"
                     src='{% static "./assets/image/service/zarinPal.png" %}'/>
            </div>
            <div class="md:w-4/12">
                <p class="text-xs text-zinc-400 pb-3 pr-2">
                    ایمیل خود را وارد کنید تا از آخرین تخفیفات باخبر بشید.
                </p>
                <div class="relative">
                    <input class="rounded-3xl rounded-tr-sm text-zinc-600 w-full bg-[#f0f0f0] px-5 py-3.5 placeholder:text-zinc-400 placeholder:text-xs focus:outline-1 focus:outline-zinc-300"
                           placeholder="ایمیل خود را وارد کنید." type="text"/>
                    <a class="top-2 absolute left-3 -rotate-90 bg-primary-500 p-1 rounded-2xl" href="#">
                        <svg class="size-7" fill="" height="36" viewbox="0 0 24 24" width="36"
                             xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_2029_2)">
                                <path clip-rule="evenodd"
                                      d="M15.536 13.707C15.4431 13.8 15.3328 13.8738 15.2114 13.9241C15.09 13.9744 14.9599 14.0003 14.8285 14.0003C14.6971 14.0003 14.5669 13.9744 14.4455 13.9241C14.3241 13.8738 14.2138 13.8 14.121 13.707L12 11.586L9.87897 13.707C9.69146 13.8947 9.43709 14.0001 9.17182 14.0002C8.90655 14.0003 8.65211 13.895 8.46447 13.7075C8.27683 13.52 8.17136 13.2657 8.17126 13.0004C8.17117 12.7351 8.27646 12.4807 8.46397 12.293L11.293 9.46503C11.4805 9.27756 11.7348 9.17224 12 9.17224C12.2651 9.17224 12.5194 9.27756 12.707 9.46503L15.536 12.293C15.7234 12.4806 15.8288 12.7349 15.8288 13C15.8288 13.2652 15.7234 13.5195 15.536 13.707Z"
                                      fill="white" fill-rule="evenodd"></path>
                            </g>
                            <defs>
                                <clippath id="clip0_2029_2">
                                    <rect fill="white" height="24" width="24"></rect>
                                </clippath>
                            </defs>
                        </svg>
                    </a>
                </div>
                <p class="text-xs text-zinc-400 pt-6 pb-3 pr-2">
                    شبکه های اجتماعی
                </p>
                <div class="grid grid-cols-6">
                    {% if social_media %}
                    {% for social in social_media %}
                    <a href="{{ social.url }}" target="_blank" rel="noopener noreferrer">
                        {% if social.platform == 'telegram' %}
                        <svg fill="none" height="40" viewbox="0 0 30 30" width="40" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_4667_548)" id="Frame">
                                <g id="Isolation Mode">
                                    <path clip-rule="evenodd"
                                          d="M8.72696 8.16637e-05H21.2724C25.8728 8.16637e-05 29.6361 3.75792 29.6361 8.35796V12.3916C25.512 14.2453 21.3518 23.4008 15.2883 21.4114C14.7889 21.7663 13.6378 23.2288 13.557 24.3385C11.4574 24.0589 9.03679 21.6527 9.32727 19.058C5.83255 16.5301 8.71846 11.8638 11.4897 9.9856C17.4293 5.96007 25.6751 9.42212 21.0884 12.3004C18.2994 14.0505 12.3354 15.2066 12.9554 10.9101C11.3194 11.382 10.2721 14.4326 12.2419 16.0223C10.4172 17.815 10.768 21.1105 12.7185 22.1925C14.6912 17.0814 21.5571 17.7494 24.3311 11.6481C26.4182 7.05861 23.3239 1.82911 17.1373 2.63243C12.4682 3.23879 8.09169 7.17735 5.90294 11.8486C3.68218 16.588 4.01267 22.9345 8.57278 26.1331C13.9393 29.8971 19.6528 26.4118 23.1132 21.8565C25.1529 19.1715 26.935 16.1972 29.6361 14.4792V21.6307C29.6361 26.2306 25.8723 30.0001 21.2724 30.0001H8.72696C4.12692 30.0001 0.363281 26.2364 0.363281 21.6364V8.36368C0.363281 3.76364 4.12692 0 8.72696 0V8.16637e-05Z"
                                          fill="#EE7F22" fill-rule="evenodd" id="Vector"></path>
                                </g>
                            </g>
                            <defs>
                                <clippath id="clip0_4667_548">
                                    <rect fill="white" height="30" width="30"></rect>
                                </clippath>
                            </defs>
                        </svg>
                        {% elif social.platform == 'whatsapp' %}
                        <svg fill="none" height="40" viewbox="0 0 40 40" width="40" xmlns="http://www.w3.org/2000/svg">
                            <g id="Frame">
                                <g filter="url(#filter0_f_4667_553)" id="Vector">
                                    <path d="M12.4639 31.5463L12.9732 31.848C15.112 33.1174 17.5644 33.7889 20.0653 33.79H20.0706C27.7508 33.79 34.0013 27.5409 34.0044 19.8602C34.0058 16.1383 32.5578 12.6382 29.927 10.0054C28.6367 8.70693 27.1016 7.67732 25.4107 6.97613C23.7198 6.27495 21.9066 5.91612 20.076 5.92043C12.3899 5.92043 6.1392 12.1688 6.13647 19.8491C6.13268 22.4716 6.87121 25.0417 8.26666 27.2623L8.59819 27.789L7.19029 32.929L12.4639 31.5463ZM3.16504 36.9109L5.54359 28.2265C4.07668 25.6851 3.30494 22.8018 3.30585 19.8479C3.30973 10.6071 10.8298 3.08936 20.0708 3.08936C24.5552 3.09163 28.7643 4.83676 31.9298 8.0046C35.0954 11.1724 36.8371 15.3832 36.8355 19.8614C36.8314 29.1015 29.3102 36.6206 20.0706 36.6206H20.0633C17.2577 36.6195 14.5009 35.9156 12.0522 34.5804L3.16504 36.9109Z"
                                          fill="#B3B3B3"></path>
                                </g>
                                <path d="M2.99219 36.7385L5.37074 28.0542C3.9013 25.5065 3.12945 22.6166 3.133 19.6756C3.13687 10.4348 10.6569 2.91699 19.8979 2.91699C24.3823 2.91927 28.5914 4.66439 31.757 7.83223C34.9226 11.0001 36.6643 15.2108 36.6627 19.689C36.6586 28.9291 29.1374 36.4483 19.8977 36.4483H19.8904C17.0849 36.4471 14.3281 35.7433 11.8794 34.4081L2.99219 36.7385Z"
                                      fill="white" id="Vector_2"></path>
                                <path d="M19.9035 5.74809C12.2173 5.74809 5.96662 11.9965 5.96388 19.6767C5.9601 22.2993 6.69862 24.8694 8.09408 27.0899L8.4256 27.6169L7.0177 32.7568L12.2916 31.374L12.8008 31.6757C14.9397 32.945 17.3921 33.6163 19.893 33.6177H19.8982C27.5784 33.6177 33.8291 27.3686 33.8321 19.6879C33.8379 17.8572 33.4805 16.0436 32.7806 14.352C32.0807 12.6604 31.0522 11.1244 29.7547 9.83303C28.4643 8.53456 26.9292 7.50493 25.2383 6.80375C23.5473 6.10256 21.734 5.74375 19.9035 5.74809Z"
                                      fill="url(#paint0_linear_4667_553)" id="Vector_3"></path>
                                <path clip-rule="evenodd"
                                      d="M15.7086 12.6695C15.3946 11.972 15.0643 11.9579 14.766 11.9458L13.963 11.936C13.6837 11.936 13.2298 12.0408 12.8461 12.4601C12.4624 12.8793 11.3799 13.8926 11.3799 15.9535C11.3799 18.0145 12.881 20.0059 13.0901 20.2857C13.2993 20.5655 15.988 24.9296 20.2459 26.6086C23.7842 28.004 24.5042 27.7265 25.2725 27.6567C26.0408 27.587 27.7509 26.6435 28.0997 25.6653C28.4486 24.6871 28.4488 23.8491 28.3442 23.6739C28.2396 23.4986 27.9603 23.3945 27.541 23.1849C27.1218 22.9753 25.0627 21.962 24.6787 21.8221C24.2948 21.6822 24.0157 21.6127 23.7361 22.032C23.4565 22.4512 22.6547 23.3943 22.4102 23.6739C22.1657 23.9534 21.9217 23.9885 21.5025 23.7791C21.0832 23.5697 19.7343 23.1272 18.1339 21.7002C16.8887 20.5899 16.0481 19.2187 15.8034 18.7996C15.5587 18.3806 15.7774 18.1537 15.9875 17.945C16.1755 17.7572 16.4063 17.4558 16.6162 17.2113C16.826 16.9668 16.8951 16.792 17.0345 16.5129C17.174 16.2338 17.1045 15.9886 16.9996 15.7792C16.8948 15.5698 16.0809 13.498 15.7086 12.6695Z"
                                      fill="white" fill-rule="evenodd" id="Vector_4"></path>
                            </g>
                            <defs>
                                <filter color-interpolation-filters="sRGB" filterunits="userSpaceOnUse" height="37.04"
                                        id="filter0_f_4667_553" width="36.8891" x="1.55594" y="1.48026">
                                    <feflood flood-opacity="0" result="BackgroundImageFix"></feflood>
                                    <feblend in="SourceGraphic" in2="BackgroundImageFix" mode="normal"
                                             result="shape"></feblend>
                                    <fegaussianblur result="effect1_foregroundBlur_4667_553"
                                                    stddeviation="0.804548"></fegaussianblur>
                                </filter>
                                <lineargradient gradientunits="userSpaceOnUse" id="paint0_linear_4667_553" x1="19.6143"
                                                x2="19.7556" y1="7.42052" y2="31.2368">
                                    <stop stop-color="#57D163"></stop>
                                    <stop offset="1" stop-color="#23B33A"></stop>
                                </lineargradient>
                            </defs>
                        </svg>
                        {% elif social.platform == 'instagram' %}
                        <svg fill="none" height="40" viewbox="0 0 512 512" width="40" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_4667_561)" id="Livello_1">
                                <path d="M16 32C24.8366 32 32 24.8366 32 16C32 7.16344 24.8366 0 16 0C7.16344 0 0 7.16344 0 16C0 24.8366 7.16344 32 16 32Z"
                                      fill="url(#paint0_linear_4667_561)" id="Vector"></path>
                                <path d="M10.8301 17.1695L12.7283 22.4236C12.7283 22.4236 12.9657 22.9152 13.2198 22.9152C13.4739 22.9152 17.2538 18.9829 17.2538 18.9829L21.4571 10.8643L10.8978 15.8132L10.8301 17.1695Z"
                                      fill="#C8DAEA" id="Vector_2"></path>
                                <path d="M13.3473 18.5171L12.9829 22.3899C12.9829 22.3899 12.8304 23.5766 14.0168 22.3899C15.2032 21.2032 16.3388 20.2882 16.3388 20.2882"
                                      fill="#A9C6D8" id="Vector_3"></path>
                                <path d="M10.8653 17.3569L6.96047 16.0846C6.96047 16.0846 6.4938 15.8953 6.64407 15.466C6.675 15.3774 6.7374 15.3021 6.92407 15.1726C7.78927 14.5696 22.9382 9.12463 22.9382 9.12463C22.9382 9.12463 23.3659 8.98049 23.6182 9.07636C23.6806 9.09568 23.7368 9.13123 23.7809 9.17937C23.8251 9.22751 23.8557 9.28652 23.8695 9.35036C23.8968 9.46311 23.9082 9.57912 23.9034 9.69503C23.9022 9.79529 23.8901 9.88823 23.8809 10.034C23.7886 11.5226 21.0275 22.633 21.0275 22.633C21.0275 22.633 20.8623 23.2832 20.2705 23.3054C20.125 23.3101 19.9801 23.2855 19.8444 23.233C19.7087 23.1805 19.5849 23.1012 19.4805 22.9998C18.319 22.0008 14.3046 19.3029 13.4175 18.7096C13.3975 18.6959 13.3807 18.6782 13.3681 18.6575C13.3556 18.6368 13.3476 18.6136 13.3447 18.5896C13.3323 18.527 13.4003 18.4496 13.4003 18.4496C13.4003 18.4496 20.3905 12.2362 20.5765 11.584C20.5909 11.5334 20.5365 11.5085 20.4634 11.5306C19.9991 11.7014 11.9509 16.784 11.0626 17.3449C10.9987 17.3642 10.9311 17.3683 10.8653 17.3569Z"
                                      fill="white" id="Vector_4"></path>
                            </g>
                            <defs>
                                <lineargradient gradientunits="userSpaceOnUse" id="paint0_linear_4667_561" x1="16"
                                                x2="16"
                                                y1="32" y2="0">
                                    <stop stop-color="#1D93D2"></stop>
                                    <stop offset="1" stop-color="#38B0E3"></stop>
                                </lineargradient>
                                <clippath id="clip0_4667_561">
                                    <rect fill="white" height="32" width="32"></rect>
                                </clippath>
                            </defs>
                        </svg>
                        {% endif %}
                    </a>
                    {% endfor %}
                    {% else %}
                    <!-- Static social media icons as fallback -->
                    <a href="">
                        <svg fill="none" height="40" viewbox="0 0 30 30" width="40" xmlns="http://www.w3.org/2000/svg">
                            <path clip-rule="evenodd"
                                  d="M124.541 256.001C124.541 183.397 183.397 124.541 256.001 124.541C328.603 124.541 387.459 183.397 387.459 256.001C387.459 328.603 328.603 387.459 256.001 387.459C183.397 387.459 124.541 328.603 124.541 256.001ZM256 341.333C208.871 341.333 170.667 303.129 170.667 256.001C170.667 208.871 208.871 170.667 256 170.667C303.128 170.667 341.333 208.871 341.333 256.001C341.333 303.129 303.128 341.333 256 341.333Z"
                                  fill="url(#paint0_linear_1_921)" fill-rule="evenodd"></path>
                            <path clip-rule="evenodd"
                                  d="M124.541 256.001C124.541 183.397 183.397 124.541 256.001 124.541C328.603 124.541 387.459 183.397 387.459 256.001C387.459 328.603 328.603 387.459 256.001 387.459C183.397 387.459 124.541 328.603 124.541 256.001ZM256 341.333C208.871 341.333 170.667 303.129 170.667 256.001C170.667 208.871 208.871 170.667 256 170.667C303.128 170.667 341.333 208.871 341.333 256.001C341.333 303.129 303.128 341.333 256 341.333Z"
                                  fill="url(#paint1_radial_1_921)" fill-rule="evenodd"></path>
                            <path d="M392.653 150.066C409.62 150.066 423.374 136.313 423.374 119.347C423.374 102.38 409.62 88.6263 392.653 88.6263C375.688 88.6263 361.934 102.38 361.934 119.347C361.934 136.313 375.688 150.066 392.653 150.066Z"
                                  fill="url(#paint2_linear_1_921)"></path>
                            <path d="M392.653 150.066C409.62 150.066 423.374 136.313 423.374 119.347C423.374 102.38 409.62 88.6263 392.653 88.6263C375.688 88.6263 361.934 102.38 361.934 119.347C361.934 136.313 375.688 150.066 392.653 150.066Z"
                                  fill="url(#paint3_radial_1_921)"></path>
                            <path clip-rule="evenodd"
                                  d="M256.001 0C186.475 0 177.757 0.294696 150.452 1.54055C123.203 2.78335 104.594 7.11132 88.3103 13.4402C71.476 19.9814 57.1995 28.7349 42.9667 42.9667C28.7349 57.1995 19.9814 71.476 13.4402 88.3103C7.11132 104.594 2.78335 123.203 1.54055 150.452C0.294696 177.757 0 186.475 0 256.001C0 325.525 0.294696 334.243 1.54055 361.548C2.78335 388.797 7.11132 407.406 13.4402 423.69C19.9814 440.524 28.7349 454.8 42.9667 469.033C57.1995 483.265 71.476 492.019 88.3103 498.561C104.594 504.889 123.203 509.217 150.452 510.459C177.757 511.705 186.475 512 256.001 512C325.525 512 334.243 511.705 361.548 510.459C388.797 509.217 407.406 504.889 423.69 498.561C440.524 492.019 454.8 483.265 469.033 469.033C483.265 454.8 492.019 440.524 498.561 423.69C504.889 407.406 509.217 388.797 510.459 361.548C511.705 334.243 512 325.525 512 256.001C512 186.475 511.705 177.757 510.459 150.452C509.217 123.203 504.889 104.594 498.561 88.3103C492.019 71.476 483.265 57.1995 469.033 42.9667C454.8 28.7349 440.524 19.9814 423.69 13.4402C407.406 7.11132 388.797 2.78335 361.548 1.54055C334.243 0.294696 325.525 0 256.001 0ZM256.001 46.126C324.355 46.126 332.452 46.3872 359.446 47.6188C384.406 48.757 397.961 52.9274 406.982 56.4333C418.931 61.0773 427.459 66.6247 436.417 75.5835C445.375 84.5412 450.923 93.0691 455.567 105.019C459.073 114.039 463.243 127.594 464.381 152.554C465.613 179.548 465.874 187.645 465.874 256.001C465.874 324.355 465.613 332.452 464.381 359.446C463.243 384.406 459.073 397.961 455.567 406.981C450.923 418.931 445.375 427.459 436.417 436.417C427.459 445.375 418.931 450.923 406.982 455.567C397.961 459.073 384.406 463.243 359.446 464.381C332.456 465.613 324.36 465.874 256.001 465.874C187.64 465.874 179.545 465.613 152.554 464.381C127.594 463.243 114.039 459.073 105.019 455.567C93.0692 450.923 84.5413 445.375 75.5835 436.417C66.6258 427.459 61.0774 418.931 56.4333 406.981C52.9275 397.961 48.757 384.406 47.6189 359.446C46.3873 332.452 46.1261 324.355 46.1261 256.001C46.1261 187.645 46.3873 179.548 47.6189 152.554C48.757 127.594 52.9275 114.039 56.4333 105.019C61.0774 93.0691 66.6248 84.5412 75.5835 75.5835C84.5413 66.6247 93.0692 61.0773 105.019 56.4333C114.039 52.9274 127.594 48.757 152.554 47.6188C179.548 46.3872 187.645 46.126 256.001 46.126Z"
                                  fill="url(#paint4_linear_1_921)" fill-rule="evenodd"></path>
                            <path clip-rule="evenodd"
                                  d="M256.001 0C186.475 0 177.757 0.294696 150.452 1.54055C123.203 2.78335 104.594 7.11132 88.3103 13.4402C71.476 19.9814 57.1995 28.7349 42.9667 42.9667C28.7349 57.1995 19.9814 71.476 13.4402 88.3103C7.11132 104.594 2.78335 123.203 1.54055 150.452C0.294696 177.757 0 186.475 0 256.001C0 325.525 0.294696 334.243 1.54055 361.548C2.78335 388.797 7.11132 407.406 13.4402 423.69C19.9814 440.524 28.7349 454.8 42.9667 469.033C57.1995 483.265 71.476 492.019 88.3103 498.561C104.594 504.889 123.203 509.217 150.452 510.459C177.757 511.705 186.475 512 256.001 512C325.525 512 334.243 511.705 361.548 510.459C388.797 509.217 407.406 504.889 423.69 498.561C440.524 492.019 454.8 483.265 469.033 469.033C483.265 454.8 492.019 440.524 498.561 423.69C504.889 407.406 509.217 388.797 510.459 361.548C511.705 334.243 512 325.525 512 256.001C512 186.475 511.705 177.757 510.459 150.452C509.217 123.203 504.889 104.594 498.561 88.3103C492.019 71.476 483.265 57.1995 469.033 42.9667C454.8 28.7349 440.524 19.9814 423.69 13.4402C407.406 7.11132 388.797 2.78335 361.548 1.54055C334.243 0.294696 325.525 0 256.001 0ZM256.001 46.126C324.355 46.126 332.452 46.3872 359.446 47.6188C384.406 48.757 397.961 52.9274 406.982 56.4333C418.931 61.0773 427.459 66.6247 436.417 75.5835C445.375 84.5412 450.923 93.0691 455.567 105.019C459.073 114.039 463.243 127.594 464.381 152.554C465.613 179.548 465.874 187.645 465.874 256.001C465.874 324.355 465.613 332.452 464.381 359.446C463.243 384.406 459.073 397.961 455.567 406.981C450.923 418.931 445.375 427.459 436.417 436.417C427.459 445.375 418.931 450.923 406.982 455.567C397.961 459.073 384.406 463.243 359.446 464.381C332.456 465.613 324.36 465.874 256.001 465.874C187.64 465.874 179.545 465.613 152.554 464.381C127.594 463.243 114.039 459.073 105.019 455.567C93.0692 450.923 84.5413 445.375 75.5835 436.417C66.6258 427.459 61.0774 418.931 56.4333 406.981C52.9275 397.961 48.757 384.406 47.6189 359.446C46.3873 332.452 46.1261 324.355 46.1261 256.001C46.1261 187.645 46.3873 179.548 47.6189 152.554C48.757 127.594 52.9275 114.039 56.4333 105.019C61.0774 93.0691 66.6248 84.5412 75.5835 75.5835C84.5413 66.6247 93.0692 61.0773 105.019 56.4333C114.039 52.9274 127.594 48.757 152.554 47.6188C179.548 46.3872 187.645 46.126 256.001 46.126Z"
                                  fill="url(#paint5_radial_1_921)" fill-rule="evenodd"></path>
                            <defs>
                                <lineargradient gradientunits="userSpaceOnUse" id="paint0_linear_1_921" x1="29.8736"
                                                x2="191.303" y1="26.9173" y2="651.345">
                                    <stop stop-color="#4E60D3"></stop>
                                    <stop offset="0.142763" stop-color="#913BAF"></stop>
                                    <stop offset="0.761458" stop-color="#D52D88"></stop>
                                    <stop offset="1" stop-color="#F26D4F"></stop>
                                </lineargradient>
                                <radialgradient cx="0" cy="0"
                                                gradienttransform="translate(155.005 512) rotate(32.1601) scale(478.18 344.131)"
                                                gradientunits="userSpaceOnUse" id="paint1_radial_1_921" r="1">
                                    <stop stop-color="#FED276"></stop>
                                    <stop offset="0.17024" stop-color="#FDBD61" stop-opacity="0.975006"></stop>
                                    <stop offset="0.454081" stop-color="#F6804D"></stop>
                                    <stop offset="1" stop-color="#E83D5C" stop-opacity="0.01"></stop>
                                </radialgradient>
                                <lineargradient gradientunits="userSpaceOnUse" id="paint2_linear_1_921" x1="29.8736"
                                                x2="191.303" y1="26.9173" y2="651.345">
                                    <stop stop-color="#4E60D3"></stop>
                                    <stop offset="0.142763" stop-color="#913BAF"></stop>
                                    <stop offset="0.761458" stop-color="#D52D88"></stop>
                                    <stop offset="1" stop-color="#F26D4F"></stop>
                                </lineargradient>
                                <radialgradient cx="0" cy="0"
                                                gradienttransform="translate(155.005 512) rotate(32.1601) scale(478.18 344.131)"
                                                gradientunits="userSpaceOnUse" id="paint3_radial_1_921" r="1">
                                    <stop stop-color="#FED276"></stop>
                                    <stop offset="0.17024" stop-color="#FDBD61" stop-opacity="0.975006"></stop>
                                    <stop offset="0.454081" stop-color="#F6804D"></stop>
                                    <stop offset="1" stop-color="#E83D5C" stop-opacity="0.01"></stop>
                                </radialgradient>
                                <lineargradient gradientunits="userSpaceOnUse" id="paint4_linear_1_921" x1="29.8736"
                                                x2="191.303" y1="26.9173" y2="651.345">
                                    <stop stop-color="#4E60D3"></stop>
                                    <stop offset="0.142763" stop-color="#913BAF"></stop>
                                    <stop offset="0.761458" stop-color="#D52D88"></stop>
                                    <stop offset="1" stop-color="#F26D4F"></stop>
                                </lineargradient>
                                <radialgradient cx="0" cy="0"
                                                gradienttransform="translate(155.005 512) rotate(32.1601) scale(478.18 344.131)"
                                                gradientunits="userSpaceOnUse" id="paint5_radial_1_921" r="1">
                                    <stop stop-color="#FED276"></stop>
                                    <stop offset="0.17024" stop-color="#FDBD61" stop-opacity="0.975006"></stop>
                                    <stop offset="0.454081" stop-color="#F6804D"></stop>
                                    <stop offset="1" stop-color="#E83D5C" stop-opacity="0.01"></stop>
                                </radialgradient>
                            </defs>
                        </svg>
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- copyright -->
        <div class="mt-10 pt-5 text-xs text-zinc-400 dark:text-primary-500 border-t border-zinc-200 dark:border-zinc-800">
            {% if footer_settings and footer_settings.copyright_text %}
                {{ footer_settings.copyright_text }}
            {% else %}
                ساخته شده توسط حامد سپهرنیا
            {% endif %}
        </div>
    </footer>
{% block extra_js %}{% endblock %}
<script>
// Dark Mode Toggle - باید قبل از سایر اسکریپت‌ها اجرا شود
(function() {
    const html = document.documentElement;
    const body = document.body;
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const moonIcon = document.getElementById('moon-icon');
    const sunIcon = document.getElementById('sun-icon');
    
    // بررسی وضعیت ذخیره شده در localStorage
    const isDarkMode = localStorage.getItem('darkMode') === 'true';
    
    // اعمال وضعیت اولیه (قبل از لود کامل صفحه)
    if (isDarkMode) {
        html.classList.add('dark');
        html.style.backgroundColor = '#111111';
        body.style.backgroundColor = '#111111';
        body.style.color = '#ffffff';
    } else {
        html.classList.remove('dark');
        html.style.backgroundColor = '';
        body.style.backgroundColor = '';
        body.style.color = '';
    }
    
    // مدیریت کلیک روی دکمه toggle (بعد از لود کامل)
    if (darkModeToggle && moonIcon && sunIcon) {
        // تنظیم آیکون اولیه
        if (isDarkMode) {
            moonIcon.style.display = 'none';
            sunIcon.style.display = 'block';
        } else {
            moonIcon.style.display = 'block';
            sunIcon.style.display = 'none';
        }
        
        darkModeToggle.addEventListener('click', function() {
            const isDark = html.classList.contains('dark');
            
            if (isDark) {
                // تغییر به حالت روشن
                html.classList.remove('dark');
                html.style.backgroundColor = '';
                body.style.backgroundColor = '';
                body.style.color = '';
                localStorage.setItem('darkMode', 'false');
                moonIcon.style.display = 'block';
                sunIcon.style.display = 'none';
            } else {
                // تغییر به حالت تاریک
                html.classList.add('dark');
                html.style.backgroundColor = '#111111';
                body.style.backgroundColor = '#111111';
                body.style.color = '#ffffff';
                localStorage.setItem('darkMode', 'true');
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'block';
            }
        });
    }
})();

// وضعیت احراز هویت برای استفاده در اسکریپت‌های فرانت
window.isAuthenticated = {{ request.user.is_authenticated|yesno:"true,false" }};
window.showAuthRequiredMessage = function() {
    alert('شما وارد حساب خود نشده‌اید');
};

// افزودن به سبد خرید - برای تمام صفحات
// جلوگیری از ثبت چندباره event listener
if (!window.cartEventListenersAttached) {
    window.cartEventListenersAttached = true;
    
    // تعریف تابع addToCart به صورت global
    window.addToCart = function(productId, colorId = null, quantity = 1, buttonElement = null) {
        if (!window.isAuthenticated) {
            if (typeof window.showAuthRequiredMessage === 'function') {
                window.showAuthRequiredMessage();
            }
            if (buttonElement) {
                buttonElement.disabled = false;
            }
            return;
        }
        
        const formData = new URLSearchParams();
        formData.append('product_id', productId);
        formData.append('quantity', quantity.toString());
        if (colorId) {
            formData.append('color_id', colorId);
        }
        
        // دریافت CSRF token
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                         document.cookie.match(/csrftoken=([^;]+)/)?.[1];
        
        fetch('/cart/add/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': csrftoken,
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: formData.toString()
        })
        .then(response => response.json())
        .then(data => {
            if (buttonElement) {
                buttonElement.disabled = false;
            }
            
            if (data.success) {
                // همیشه صفحه را reload کن تا تعداد محصولات در header و سبد خرید به‌روزرسانی شود
                location.reload();
            } else {
                alert(data.error || 'خطا در افزودن به سبد خرید');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            if (buttonElement) {
                buttonElement.disabled = false;
            }
            alert('خطا در ارتباط با سرور');
        });
    };
    
    document.addEventListener('DOMContentLoaded', function() {
        // مدیریت دکمه‌های افزودن به سبد خرید
        const addToCartButtons = document.querySelectorAll('.add-to-cart-btn, .add-to-cart');
        
        addToCartButtons.forEach(btn => {
            // بررسی اینکه آیا event listener قبلاً اضافه شده یا نه
            if (btn.dataset.listenerAttached === 'true') {
                return;
            }
            
            btn.dataset.listenerAttached = 'true';
            
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation(); // جلوگیری از انتشار event
                
                const productId = this.dataset.productId;
                if (!productId) return;
                
                // غیرفعال کردن دکمه برای جلوگیری از کلیک‌های مکرر
                if (this.disabled) return;
                this.disabled = true;
                
                // دریافت رنگ انتخاب شده (اگر وجود دارد)
                const colorInput = document.querySelector('input[name="color"]:checked');
                const colorId = colorInput ? colorInput.value : null;
                
                // دریافت تعداد از input (اگر وجود دارد)
                const quantityInput = this.closest('.quantity-container')?.querySelector('input[type="number"]') ||
                                     document.querySelector('.quantity-container input[type="number"]') ||
                                     document.querySelector('input[name="quantity"]');
                const quantity = quantityInput ? parseInt(quantityInput.value) || 1 : 1;
                
                window.addToCart(productId, colorId, quantity, this);
            }, { once: false });
        });
    });
}
    
// مدیریت دکمه‌های علاقه‌مندی - برای تمام صفحات
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.toggle-favorite').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            const productId = this.dataset.productId;
            if (!productId) return;
            
            toggleFavorite(productId, this);
        });
    });
    
    // مدیریت دکمه‌های + و - در dropdown header
    document.querySelectorAll('.header-update-quantity').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            const itemId = this.dataset.itemId;
            const action = this.dataset.action;
            const input = document.querySelector(`.header-cart-quantity[data-item-id="${itemId}"]`);
            let quantity = parseInt(input.value);
            
            if (action === 'increment') {
                quantity++;
            } else if (action === 'decrement' && quantity > 1) {
                quantity--;
            }
            
            updateHeaderCartItem(itemId, quantity);
        });
    });
    
    // مدیریت دکمه حذف در dropdown header
    document.querySelectorAll('.header-remove-item').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            const itemId = this.dataset.itemId;
            if (confirm('آیا مطمئن هستید که می‌خواهید این محصول را از سبد خرید حذف کنید؟')) {
                removeHeaderCartItem(itemId);
            }
        });
    });
    
    function updateHeaderCartItem(itemId, quantity) {
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                         document.cookie.match(/csrftoken=([^;]+)/)?.[1];
        
        fetch(`/cart/update/${itemId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': csrftoken,
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `quantity=${quantity}`
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // به‌روزرسانی مقدار input در dropdown header
                const headerQuantityInput = document.querySelector(`.header-cart-quantity[data-item-id="${itemId}"]`);
                if (headerQuantityInput) {
                    headerQuantityInput.value = quantity;
                }
                
                // به‌روزرسانی قیمت آیتم در dropdown header
                const headerItemTotal = document.querySelector(`.header-cart-item-total[data-item-id="${itemId}"] .text-lg`);
                if (headerItemTotal) {
                    headerItemTotal.textContent = data.item_total.toLocaleString();
                }
                
                // به‌روزرسانی تعداد سبد خرید در header
                const cartCount = document.querySelector('.cart-count');
                if (cartCount) {
                    cartCount.textContent = data.cart_items_count || 0;
                    if (data.cart_items_count > 0) {
                        cartCount.style.display = 'flex';
                    } else {
                        cartCount.style.display = 'none';
                    }
                }
                
                // به‌روزرسانی قیمت کل در dropdown header
                const cartTotalPrice = document.querySelector('.header-cart-total-price');
                if (cartTotalPrice) {
                    cartTotalPrice.textContent = data.cart_total.toLocaleString();
                }
                
                // اگر در صفحه سبد خرید هستیم، صفحه را reload کن
                const currentPath = window.location.pathname;
                if (currentPath === '/cart/' || currentPath === '/cart' || currentPath.startsWith('/cart/')) {
                    location.reload();
                }
            } else {
                alert(data.error || 'خطا در به‌روزرسانی');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('خطا در ارتباط با سرور');
        });
    }
    
    function removeHeaderCartItem(itemId) {
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                         document.cookie.match(/csrftoken=([^;]+)/)?.[1];
        
        fetch(`/cart/remove/${itemId}/`, {
            method: 'POST',
            headers: {
                'X-CSRFToken': csrftoken,
                'Content-Type': 'application/x-www-form-urlencoded',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // حذف آیتم از dropdown header
                const cartItemElement = document.getElementById(`header-cart-item-${itemId}`);
                if (cartItemElement) {
                    cartItemElement.remove();
                }
                
                // به‌روزرسانی تعداد سبد خرید در header
                const cartCount = document.querySelector('.cart-count');
                if (cartCount) {
                    cartCount.textContent = data.cart_items_count || 0;
                    if (data.cart_items_count > 0) {
                        cartCount.style.display = 'flex';
                    } else {
                        cartCount.style.display = 'none';
                    }
                }
                
                // به‌روزرسانی قیمت کل در dropdown header
                const cartTotalPrice = document.querySelector('.header-cart-total-price');
                if (cartTotalPrice) {
                    cartTotalPrice.textContent = data.cart_total.toLocaleString();
                }
                
                // اگر تعداد آیتم‌ها صفر شد، پیام خالی بودن سبد خرید را نمایش بده
                if (data.cart_items_count === 0) {
                    const cartItemsList = document.querySelector('.main-scroll');
                    const cartContainer = cartItemsList ? cartItemsList.closest('.h-72, .h-64') : null;
                    if (cartContainer) {
                        cartContainer.innerHTML = '<div class="text-zinc-600 text-center py-10 font-yekanBakhRegular flex justify-center items-center gap-x-1"><span>سبد خرید خالی است !</span></div>';
                    }
                }
                
                // اگر در صفحه سبد خرید هستیم، صفحه را reload کن
                const currentPath = window.location.pathname;
                if (currentPath === '/cart/' || currentPath === '/cart' || currentPath.startsWith('/cart/')) {
                    location.reload();
                }
            } else {
                alert(data.error || 'خطا در حذف');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('خطا در ارتباط با سرور');
        });
    }
    
    function toggleFavorite(productId, buttonElement) {
        // دریافت CSRF token
        const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]')?.value || 
                         document.cookie.match(/csrftoken=([^;]+)/)?.[1];
        
        fetch('/dashboard/favorites/toggle/', {
            method: 'POST',
            headers: {
                'X-CSRFToken': csrftoken,
                'Content-Type': 'application/x-www-form-urlencoded',
            },
            body: `product_id=${productId}`
        })
        .then(response => {
            if (response.status === 401) {
                return { success: false, error: 'لطفا ابتدا وارد حساب کاربری خود شوید' };
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                // پیدا کردن آیکون مربوط به این دکمه
                const icon = buttonElement.querySelector('.favorite-icon') || buttonElement.querySelector('svg');
                const svgParent = buttonElement.closest('a') || buttonElement;
                
                if (icon) {
                    // پیدا کردن عنصر background (SVG یا والد آن)
                    const bgElement = icon.closest('.bg-white') || icon.closest('.bg-red-500') || 
                                     svgParent.querySelector('.bg-white') || svgParent.querySelector('.bg-red-500') ||
                                     (icon.parentElement && icon.parentElement.classList.contains('bg-white') ? icon.parentElement : null) ||
                                     (icon.parentElement && icon.parentElement.classList.contains('bg-red-500') ? icon.parentElement : null);
                    
                    if (data.is_favorite) {
                        // آیکون سفید و background قرمز
                        icon.setAttribute('fill', '#ffffff');
                        // حذف کلاس‌های fill قبلی
                        Array.from(icon.classList).forEach(cls => {
                            if (cls.startsWith('fill-')) {
                                icon.classList.remove(cls);
                            }
                        });
                        icon.classList.add('fill-white');
                        
                        // تغییر background به قرمز
                        if (bgElement) {
                            bgElement.classList.remove('bg-white');
                            bgElement.classList.add('bg-red-500');
                        } else if (icon.parentElement) {
                            // اگر background element پیدا نشد، به والد SVG اضافه کن
                            icon.parentElement.classList.remove('bg-white');
                            icon.parentElement.classList.add('bg-red-500');
                        }
                    } else {
                        // آیکون مشکی و background سفید
                        icon.setAttribute('fill', '#000000');
                        // حذف کلاس‌های fill قبلی
                        Array.from(icon.classList).forEach(cls => {
                            if (cls.startsWith('fill-')) {
                                icon.classList.remove(cls);
                            }
                        });
                        icon.classList.add('fill-black', 'fill-zinc-700');
                        
                        // تغییر background به سفید
                        if (bgElement) {
                            bgElement.classList.remove('bg-red-500');
                            bgElement.classList.add('bg-white');
                        } else if (icon.parentElement) {
                            // اگر background element پیدا نشد، به والد SVG اضافه کن
                            icon.parentElement.classList.remove('bg-red-500');
                            icon.parentElement.classList.add('bg-white');
                        }
                    }
                }
            } else {
                alert(data.error || 'خطا در به‌روزرسانی علاقه‌مندی');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('خطا در ارتباط با سرور');
        });
    }
});
</script>
</body>
<script src='{% static "./assets/js/swiper.min.js" %}'></script>
<script src='{% static "./assets/js/sliders.js" %}'></script>
<script src='{% static "./assets/js/nouislider.min.js" %}'></script>
<script src='{% static "./assets/js/main.js" %}'></script>
</html>