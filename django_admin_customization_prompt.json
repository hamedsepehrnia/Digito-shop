{
  "title": "Django Admin Panel Complete Customization Guide",
  "description": "A comprehensive guide for customizing Django admin panel with Persian localization, Jalali dates, hidden models, singleton patterns, and clean UI",
  "requirements": [
    "Add verbose_name and verbose_name_plural to all model Meta classes in Persian",
    "Add verbose_name to all model fields in Persian",
    "Add ordering to Meta classes for consistent sorting",
    "Create a custom AdminSite class that dynamically loads settings from a singleton AdminSettings model",
    "Implement Jalali (Persian) date conversion with a toggle setting to switch between Jalali and Gregorian dates",
    "Create an AdminSettings model with fields: use_jalali_date (Boolean), site_title, site_header, site_index_title, show_hidden_models (Boolean)",
    "Implement a utility function format_date_for_admin() that converts dates based on AdminSettings.use_jalali_date",
    "Hide less frequently used models by default (e.g., OrderItem, CartItem, ProductImage, ProductSpecification, PhoneOTP, AboutSection) but allow them to be shown via show_hidden_models setting",
    "Use signal handlers to dynamically register/unregister hidden models when AdminSettings.show_hidden_models changes",
    "Implement singleton pattern for AdminSettings, ContactInfo, and FooterSettings models (only one record can exist, disable add/delete buttons)",
    "Add Persian font (Vazir) to admin panel using CDN link in base_site.html template",
    "Remove duplicate date fields from list_display and fieldsets (only show jalali_created, not both created_at and jalali_created)",
    "Add proper list_display, list_filter, search_fields, list_editable, readonly_fields, fieldsets, date_hierarchy, list_per_page to all admin classes",
    "Create custom display methods for dates (jalali_created, jalali_updated) that use format_date_for_admin()",
    "Add AppConfig verbose_name in Persian for all apps",
    "Ensure all admin classes are registered with the custom AdminSite instance",
    "Use format_html for displaying HTML content in admin (e.g., status badges, image previews)",
    "Add inline admin classes for related models (e.g., ProductImageInline, OrderItemInline)"
  ],
  "file_structure": {
    "core/models.py": "Create AdminSettings model with singleton pattern",
    "core/admin_utils.py": "Create format_date_for_admin() utility function",
    "core/apps.py": "Add signal handler in ready() method to refresh hidden models when AdminSettings changes",
    "Digito/admin.py": "Create custom AdminSite, register all models, implement dynamic model registration based on show_hidden_models",
    "Digito/urls.py": "Use custom admin_site.urls instead of admin.site.urls",
    "templates/admin/base_site.html": "Add Vazir font CDN and apply to body, input, textarea, select, button",
    "app_name/admin.py": "Remove @admin.register decorators, add comprehensive admin configurations with Persian verbose names",
    "app_name/apps.py": "Add verbose_name to AppConfig class"
  },
  "code_examples": {
    "AdminSettings_model": "class AdminSettings(models.Model):\n    use_jalali_date = models.BooleanField(default=True, verbose_name='استفاده از تاریخ شمسی')\n    show_hidden_models = models.BooleanField(default=False, verbose_name='نمایش مدل‌های پنهان شده')\n    \n    def save(self, *args, **kwargs):\n        if not self.pk and AdminSettings.objects.exists():\n            return\n        super().save(*args, **kwargs)\n    \n    @classmethod\n    def get_settings(cls):\n        return cls.objects.get_or_create(pk=1, defaults={...})[0]",
    "format_date_for_admin": "def format_date_for_admin(date_obj, include_time=True):\n    try:\n        settings = AdminSettings.get_settings()\n        if settings.use_jalali_date:\n            return JalaliDateTime(date_obj).strftime(format)\n        return date_obj.strftime(format)\n    except:\n        return date_obj.strftime(format)",
    "Custom_AdminSite": "class CustomAdminSite(AdminSite):\n    def each_context(self, request):\n        context = super().each_context(request)\n        settings = AdminSettings.get_settings()\n        context['admin_settings'] = settings\n        return context\n\nadmin_site = CustomAdminSite(name='custom_admin')",
    "Dynamic_model_registration": "def update_hidden_models():\n    settings = AdminSettings.get_settings()\n    hidden_models = [(Model1, Admin1), (Model2, Admin2)]\n    for model, admin_class in hidden_models:\n        if settings.show_hidden_models:\n            if not admin_site.is_registered(model):\n                admin_site.register(model, admin_class)\n        else:\n            if admin_site.is_registered(model):\n                admin_site.unregister(model)",
    "Signal_handler": "def ready(self):\n    from django.db.models.signals import post_save\n    from core.models import AdminSettings\n    from Digito.admin import update_hidden_models\n    \n    def refresh_hidden_models(sender, instance, **kwargs):\n        if isinstance(instance, AdminSettings):\n            update_hidden_models()\n    \n    post_save.connect(refresh_hidden_models, sender=AdminSettings)",
    "Admin_class_example": "class ProductAdmin(admin.ModelAdmin):\n    list_display = ['title', 'price', 'jalali_created']\n    list_filter = ['category', 'created_at']\n    search_fields = ['title', 'description']\n    readonly_fields = ['jalali_created']\n    \n    def jalali_created(self, obj):\n        return format_date_for_admin(obj.created_at, include_time=False)\n    jalali_created.short_description = 'تاریخ ثبت'"
  },
  "best_practices": [
    "Always use format_date_for_admin() instead of direct JalaliDateTime conversion",
    "Never show both created_at and jalali_created in list_display or fieldsets",
    "Use format_html() for displaying HTML content in admin",
    "Implement singleton pattern for settings models using save() override and has_add_permission/has_delete_permission",
    "Register models conditionally based on settings, not hardcoded",
    "Use signal handlers in AppConfig.ready() for dynamic behavior",
    "Keep admin classes clean and organized with proper fieldsets",
    "Add meaningful verbose_name to all fields and models",
    "Use readonly_fields for computed values and dates",
    "Implement proper list_display_links for better UX"
  ],
  "hidden_models_criteria": [
    "Models that are accessible via inlines (e.g., OrderItem via Order)",
    "Models that are rarely accessed directly (e.g., PhoneOTP for debugging)",
    "Models that are part of a parent model (e.g., ProductImage, ProductSpecification)",
    "Models that can be managed through related models (e.g., CartItem via Cart)"
  ],
  "persian_font_setup": {
    "cdn_link": "https://cdn.jsdelivr.net/gh/rastikerdar/vazirfont@v30.1.0/dist/font-face.css",
    "css_application": "body, input, textarea, select, button { font-family: 'Vazir', sans-serif; }"
  },
  "notes": [
    "The AdminSettings model must be created first before other admin customizations",
    "Handle OperationalError gracefully when new fields are added but migrations haven't run yet",
    "Use try-except blocks when accessing AdminSettings.get_settings() during app initialization",
    "Signal handlers must be connected in AppConfig.ready() to ensure they're loaded",
    "Always test the show_hidden_models toggle after implementation"
  ]
}

